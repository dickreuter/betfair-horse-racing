/*
@license
Webix SpreadSheet v.5.1.0
This software is covered by Webix Trial License.
Usage without proper license is prohibited.
(c) XB Software Ltd.
*/
!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="/codebase/",t(0)}([function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n(12),n(13);var i=n(30),r=o(i),a=n(36),s=o(a),l=n(42),u=o(l),c=n(43),f=o(c),d=n(48),h=o(d),p=n(50),v=o(p),g=n(64),w=o(g),m=n(65),b=n(90),_=n(104),y=o(_),x=n(105);n(106);var C={name:"spreadsheet",_base_index:{count:1},defaults:{spans:!0,rowCount:50,math:!0,columnCount:20,resizeCell:!0,sheetTabWidth:90,conditionStyle:(0,x.getDefaultStyles)()},$init:function(){this.$index=this._base_index.count++,this.$view.className+=" webix_ssheet",this.$ready.unshift(this._sub_init),this.$ready.push(this._set_handlers)},_sub_init:function(){var e=this.config,t=[];!e.readonly&&e.menu&&t.push(y.init(this)),e.readonly||e.toolbar===!1||t.push(r.init(this)),e.subbar&&t.push(e.subbar),e.liveEditor&&t.push(f.init(this)),t.push(s.init(this,{editable:!e.readonly,spans:!0,clipboard:e.clipboard,liveEditor:e.liveEditor})),e.bottombar&&(e.bottombar===!0?t.push(h.init(this)):t.push(e.bottombar)),e.readonly||(w.init(this),v.init(this)),this.rows_setter(t)},_set_handlers:function(){var e=this;this._table||(this._table=this.$$("cells"),(0,m.operations)(this),s.reset(this,this.config.columnCount,this.config.rowCount),u.init(this),this._table.attachEvent("onAfterAreaAdd",function(){return e.callEvent("onAfterSelect",[e.getSelectedId(!0)])}),this.callEvent("onComponentInit",[]))},$onLoad:function(e,t){this._set_handlers(),e.excel?e=this._parseExcel(e,t):e.data||"string"!=typeof e||!t.cell&&!t.row||(e=this._parseCsv(e,t)),h.load(this,e)}};(0,b.api)(C),webix.protoUI(C,webix.AtomDataLoader,webix.IdSpace,webix.ui.layout)},,,,,,,,,,,,function(e,t){"use strict";webix.i18n.spreadsheet={labels:{common:"Common",currency:"Currency",number:"Number",percent:"Percent","undo-redo":"Undo/Redo",font:"Font",text:"Text",cell:"Cell",align:"Align",format:"Number",column:"Column",borders:"Borders",px:"px",apply:"Apply",cancel:"Cancel",save:"Save",sheet:"Sheet","conditional-format":"Conditional Format",condition:"Condition","conditional-value":"Value","conditional-style":"Style",range:"Range","range-title":"Named ranges","range-name":"Name","range-cells":"Range","image-or":"or","image-title":"Add image","image-upload":"Select file for upload","image-url":"URL (e.g. http://*)","sparkline-title":"Add sparkline","sparkline-type":"Type","sparkline-range":"Range","sparkline-color":"Color","sparkline-positive":"Positive","sparkline-negative":"Negative","format-title":"Set format","format-pattern":"Format pattern","dropdown-title":"Add dropdown","dropdown-range":"Range",ok:"OK","import-title":"Import","import-not-support":"Sorry, your browser does not support import","export-title":"Export","export-name":"Name of xslx file","export-all-sheets":"Export all sheets","link-title":"Add Link","link-name":"Text","link-url":"URL",image:"Image",graph:"Graph",display:"Display",value:"Value","range-remove-confirm":"Are you sure you want to remove the range permanently?","sheet-remove-confirm":"Are you sure you want to remove the sheet permanently?","merge-cell-confirm":"Only the left top value will remain after merging. Continue?","error-range":"The range is incorrect!",print:"Print","print-title":"Before you print..","print-settings":"General settings","print-paper":"Paper size","print-layout":"Layout","current-sheet":"Current sheet","all-sheets":"All sheets",selection:"Selected cells",borderless:"Hide gridlines","sheet-names":"Show sheet names","skip-rows":"Skip empty rows",margin:"Hide margins","page-letter":"Letter","page-a4":"A4 (210x297mm)","page-a3":"A3 (297x420mm)","page-width":"Page width","page-actual":"Actual Size","page-portrait":"Portrait","page-landscape":"Landscape"},tooltips:{color:"Font color",background:"Background color","font-family":"Font family","font-size":"Font size","text-align":"Horizontal align","vertical-align":"Vertical align",borders:"Borders","borders-no":"Clear borders","borders-left":"Left border","borders-top":"Top border","borders-right":"Right border","borders-bottom":"Bottom border","borders-all":"All borders","borders-outer":"Outer borders","borders-top-bottom":"Top and bottom borders","borders-color":"Border color","align-left":"Left align","align-center":"Center align","align-right":"Right align","align-top":"Top align","align-middle":"Middle align","align-bottom":"Bottom align",span:"Merge",wrap:"Text wrap",undo:"Undo",redo:"Redo",format:"Number format","font-weight":"Bold","font-style":"Italic","text-decoration":"Underline","hide-gridlines":"Hide/show gridlines","hide-headers":"Hide/show headers","freeze-columns":"Freeze/unfreeze columns","add-range":"Set name for the selected range",conditional:"Conditional formatting","add-sheet":"Add Sheet","lock-cell":"Lock/unlock cell","clear-styles":"Clear styles","add-link":"Add link",row:"Rows",column:"Columns",sheet:"Sheet"},menus:{"remove-sheet":"Remove sheet","rename-sheet":"Rename sheet",file:"File","new":"New","new-sheet":"New sheet","excel-import":"Import from Excel","excel-export":"Export to Excel",sheet:"Sheets","copy-sheet":"Copy to new sheet",edit:"Edit",undo:"Undo",redo:"Redo",columns:"Columns","insert-column":"Insert column","delete-column":"Delete column","show-column":"Show column","hide-column":"Hide column",rows:"Rows","insert-row":"Insert row","delete-row":"Delete row","show-row":"Show row","hide-row":"Hide row",insert:"Insert","conditional-format":"Conditional format","clear-styles":"Clear styles","add-image":"Image","add-sparkline":"Graph",data:"Data","add-link":"Add link","add-range":"Named ranges",sort:"Sort","sort-asc":"Sort A to Z","sort-desc":"Sort Z to A","create-filter":"Create filter",view:"View","freeze-columns":"Freeze/unfreeze columns","freeze-rows":"Freeze/unfreeze rows","hide-gridlines":"Hide/show gridlines","hide-headers":"Hide/show headers","add-dropdown":"Add dropdown","custom-format":"Custom format","lock-cell":"Lock/unlock cell",print:"Print"}}},function(e,t,n){"use strict";n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(24),n(25),n(26),n(27),n(28),n(29)},function(e,t){"use strict";webix.protoUI({name:"ssheet-align",$cssName:"richselect",$init:function(e){e.options={view:"datasuggest",body:{view:"ssheet-icons",tooltip:{template:"#tooltip#"},xCount:3,yCount:1},data:e.data}}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({name:"ssheet-borders-suggest",defaults:{width:300},$init:function(e){e.body={margin:6,cols:[{view:"ssheet-icons",scroll:!1,select:!0,xCount:4,yCount:2,tooltip:{template:function(e){return webix.i18n.spreadsheet.tooltips["borders-"+e.id]}},on:{onAfterSelect:function(){var e=this.getParentView().getParentView();e.updateMasterValue(!0)}},template:function(e){var t="webix_ssheet_button_icon webix_ssheet_icon_borders_"+e.value;return"<span class='"+t+"'></span>"},data:e.data},{view:"ssheet-separator"},{rows:[{view:"ssheet-color",css:e.css,name:e.name,width:62,tooltip:webix.i18n.spreadsheet.tooltips["borders-color"],title:"<span class='webix_icon fa-pencil'></span>",on:{onChange:function(){var e=this.getParentView().getParentView().getParentView();e.updateMasterValue(!1)}}},{}]}]}},updateMasterValue:function(e){var t=this.getValue(),n=webix.$$(this.config.master);n.setValue(t),e&&this.hide()},setValue:function(e){e[0]&&this.getList().select(e[0]),e[1]&&this.getColorView().setValue(e[1])},getValue:function(){return[this.getList().getSelectedId(),this.getColorView().getValue()||""]},getList:function(){return this.getBody().getChildViews()[0]},getColorView:function(){return this.getBody().getChildViews()[2].getChildViews()[0]}},webix.ui.suggest),webix.protoUI({name:"ssheet-borders",$cssName:"richselect",defaults:{text:"<span class='webix_ssheet_button_icon webix_ssheet_icon_borders'>"},$init:function(e){e.options={view:"ssheet-borders-suggest",fitMaster:!1,data:e.data},this.$ready.push(webix.bind(function(){this.getPopup().config.master=this.config.id},this))},setValue:function(e){return webix.isArray(e)&&(this.config.value&&e[0]==this.config.value[0]&&e[1]==this.config.value[1]||this.getPopup().setValue(e),this.config.value=e,e[0]&&this.callEvent("onChange")),e},getValue:function(){return this.getPopup().getValue().join(",")},getList:function(){return this.getPopup().getBody().getChildViews()[0]},getColorView:function(){return this.getPopup().getBody().getChildViews()[1].getChildViews()[0]}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({$cssName:"colorboard",name:"ssheet-colorboard",defaults:{css:"webix_ssheet_colorboard",palette:[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]}},webix.ui.colorboard),webix.protoUI({$cssName:"richselect",name:"ssheet-color",defaults:{css:"webix_ssheet_color",icon:"angle-down",suggest:{height:202,borderless:!0,body:{view:"ssheet-colorboard",on:{onSelect:function(e){this.getParentView().setMasterValue({value:e})}}}}},$init:function(){this.$view.className+=" webix_ssheet_color"},$renderInput:function(e,t,n){var o=this.renderColor.call(this);return t=t.replace(/([^>]>)(.*)(<\/div)/,function(t,n,i,r){return n+e.title+o+r}),webix.ui.colorpicker.prototype.$renderInput.call(this,e,t,n)},$setValue:function(e){var t=webix.$$(this.config.popup.toString()),n=t.getBody();e&&(n.setValue(e),this.config.value=e,this.getColorNode().style.backgroundColor=e)},renderColor:function(){return"<div class='webix_ssheet_cp_color' style='background-color:"+this.config.value+";'> </div>"},getColorNode:function(){return this.$view.firstChild.firstChild.childNodes[1]},$renderIcon:function(){return webix.ui.text.prototype.$renderIcon.apply(this,arguments)}},webix.ui.colorpicker)},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};webix.protoUI({$cssName:"window",name:"ssheet-dialog",$init:function(e){this.$view.className+=" webix_ssheet_dialog",this.config.buttons=e.buttons},getHeaderConfig:function(e){return{paddingX:10,paddingY:5,height:60,cols:[{view:"label",label:e},{view:"button",type:"htmlbutton",css:"close",label:"<span class='webix_ssheet_button_icon webix_ssheet_hide_icon'></span>",width:40,click:function(){var e=this.getTopParentView();e.callEvent("onHideClick",[])}}]}},getBodyConfig:function(e){e.borderless=!0;var t=this.getFormElements(e),n={view:"form",css:"webix_ssheet_form",paddingY:0,elements:t};return n},getFormElements:function(e){var t;return webix.isArray(e)?t=e:(t=[],t.push(e)),this.config.buttons&&(t.push({height:1}),t.push({margin:10,cols:[{},{view:"button",type:"cancel",label:webix.i18n.spreadsheet.labels.cancel,autowidth:!0,click:function(){var e=this.getTopParentView();e.callEvent("onCancelClick",[])}},{view:"button",label:webix.i18n.spreadsheet.labels.save,autowidth:!0,click:function(){var e=this.getTopParentView();e.callEvent("onSaveClick",[])}}]})),t.push({height:10,borderless:!0}),t},body_setter:function(e){return"object"==("undefined"==typeof e?"undefined":n(e))&&(e.paddingY=e.paddingY||0,"form"==e.view&&e.elements?(e.elements=this.getFormElements(e.elements),e.css||(e.css="webix_ssheet_form")):e=this.getBodyConfig(e)),webix.ui.window.prototype.body_setter.call(this,e)},head_setter:function(e){return e&&(e=this.getHeaderConfig(e)),webix.ui.window.prototype.head_setter.call(this,e)},defaults:{padding:0,move:!0,head:!0,buttons:!0,autofocus:!1,width:350}},webix.ui.window,webix.IdSpace),webix.protoUI({$cssName:"datatable",name:"ssheet-dialog-table",$init:function(e){e.headerRowHeight||(e.headerRowHeight=34),this.$view.className+=" webix_ssheet_table webix_ssheet_dialog_table"}},webix.ui.datatable)},function(e,t){"use strict";webix.protoUI({name:"ssheet-form-popup",defaults:{padding:0,borderless:!0},$init:function(){this.$view.className+=" webix_ssheet_form"}},webix.ui.suggest),webix.protoUI({name:"ssheet-form-suggest",defaults:{padding:0,borderless:!0},$init:function(){this.$view.className+=" webix_ssheet_suggest"}},webix.ui.suggest),webix.protoUI({$cssName:"colorpicker",name:"ssheet-colorpicker",$init:function(){this.$view.className+=" webix_ssheet_colorpicker"},defaults:{icon:"angle-down",suggest:{height:202,borderless:!0,body:{view:"ssheet-colorboard",on:{onSelect:function(e){this.getParentView().setMasterValue({value:e})}}}}}},webix.ui.colorpicker)},function(e,t){"use strict";webix.protoUI({name:"formlate",setValue:function(e){return this.setHTML(e)},getValue:function(){return""}},webix.ui.template)},function(e,t){"use strict";webix.protoUI({name:"ssheet-icons",$cssName:"dataview",$init:function(){this.$view.className+=" webix_ssheet_dataview"},defaults:{borderless:!0,template:"<span class='webix_ssheet_button_icon #css#' ></span>",type:{width:36,height:36}}},webix.ui.dataview)},function(e,t){"use strict";webix.protoUI({name:"ssheet-suggest",defaults:{padding:0,css:"webix_ssheet_suggest"}},webix.ui.contextmenu)},function(e,t,n){"use strict";n(23),webix.protoUI({name:"live-editor",$cssName:"text webix_ssheet_formula",defaults:{keyPressTimeout:25},$init:function(e){var t=this;e.suggest={view:"suggest-formula",data:e.suggestData},this.attachEvent("onKeyPress",function(e){13===e&&new Date-(t._last_value_set||0)>300&&(t.updateCellValue(),webix.delay(function(){this.getTopParentView()._table.moveSelection("down")},t))}),this.attachEvent("onAfterRender",webix.once(function(){var e=this.getInputNode(),t=webix.env.isIE8?"propertychange":"input";webix.event(e,t,webix.bind(this.paintValue,this)),webix.event(e,"keydown",webix.bind(this.endEdit,this))}))},endEdit:function(e){var t=e.which||e.keyCode,n=this.getInputNode();if(9==t||t>36&&t<41&&"="!==n.value.charAt(0)){var o=40==t?"down":39===t?"right":37==t?"left":"up";9===t&&(o="right"),this.updateCellValue(),this.getTopParentView()._table.moveSelection(o)}},paintValue:function(){var e=this.getTopParentView(),t=this.config.activeCell,n=e._table.getItemNode(t);t&&n&&(n.innerHTML=this.getValue())},updateCellValue:function(){var e=this.getValue(),t=this.getTopParentView(),n=this.config.activeCell;n?e!=t.getCellValue(n.row,n.column)&&(this.config.value=e,t.setCellValue(n.row,n.column,e),t.refresh()):this.setValue("")},$setValueHere:function(e){this.setValueHere(e)},setValueHere:function(e){this._last_value_set=new Date;var t=this.getInputNode();if(t.value&&"="===t.value.charAt(0)){var n=t.value,o=t.selectionStart,i=n.substring(0,o),r=n.substring(o);i=i.replace(/([a-zA-Z\(]+)$/,e),t.value=i+"("+r,t.setSelectionRange(i.length+1,i.length+1)}},expectRange:function(){var e=this.getValue().trim(),t=e.substr(e.length-1,1);return t.match(/[\(\,]/)},expectOperator:function(){var e=this.getValue().trim(),t=e.substr(e.length-1,1);return"="==e.substr(0,1)&&t.match(/[\+\&\-\/\*\%\=\(:\,]/)},setRange:function(e){var t=this.getInputNode(),n=t.selectionStart,o=this.getValue(),i=o.substring(0,n)+e,r=o.substring(n);t.value=i+r,t.setSelectionRange(i.length+1,i.length+1),this.focus()}},webix.ui.text)},function(e,t){"use strict";webix.protoUI({name:"suggest-formula",defaults:{fitMaster:!1,width:200,filter:function(e,t){var n=webix.$$(this.config.master).getInputNode(),o=n.selectionStart,i=n.value;if("="===i.charAt(0)){var r=i.substring(0,o).match(/([a-zA-Z]+)$/),a=i.charAt(o).search(/[^A-Za-z0-9]/);return!r||o!==i.length&&0!==a||(t=r[0]),0===e.value.toString().toLowerCase().indexOf(t.toLowerCase())}}},$init:function(){var e=this;this.attachEvent("onBeforeShow",function(t){if(t.tagName){if(!t.value||"="!==t.value.charAt(0))return!1;var n=webix.html.offset(t),o=9,i=n.y+n.height,r=n.x+t.selectionStart*o;return webix.ui.popup.prototype.show.apply(e,[{x:r,y:i}]),!1}})},setMasterValue:function(e,t){var n=e.id?this.getItemText(e.id):e.text||e.value,o=webix.$$(this.config.master);o.setValueHere(n),t||this.hide(!0),this.callEvent("onValueSuggest",[e,n])},$enterKey:function(e){if(e.isVisible())return webix.ui.suggest.prototype.$enterKey.apply(this,arguments)}},webix.ui.suggest)},function(e,t){"use strict";webix.protoUI({name:"ssheet-separator",defaults:{css:"webix_ssheet_toolbar_spacer",template:" ",width:1,borderless:!0}},webix.ui.view)},function(e,t){"use strict";webix.protoUI({name:"sheets",defaults:{layout:"x",borderless:!0,css:"ssheet_list_sheets",scrollX:!1,select:!0,scroll:!1},getVisibleCount:function(){return Math.floor(this.$width/this.type.width)}},webix.EditAbility,webix.ui.list)},function(e,t){"use strict";webix.protoUI({$cssName:"toggle",name:"ssheet-toggle",toggle:function(){var e=this.getValue()==this.config.onValue;this.setValue(!e)},$setValue:function(e){e==this.config.offValue?e=!1:e==this.config.onValue&&(e=!0),webix.ui.toggle.prototype.$setValue.call(this,e)},getValue:function(){var e=this.config,t=e.value;return t&&t!=e.offValue?e.onValue||!0:e.offValue||!1},defaults:{template:function(e,t){var n=e.value===!0||e.value==e.onValue?" webix_pressed":"",o=t.$renderInput(e,t);return"<div class='webix_el_box"+n+"' style='width:"+e.awidth+"px; height:"+e.aheight+"px'>"+o+"</div>"}}},webix.ui.toggle)},function(e,t){"use strict";webix.protoUI({name:"ssheet-bar-title",defaults:{borderless:!0},$init:function(){this.$view.className+=" webix_ssheet_subbar_title"}},webix.ui.template)},function(e,t){"use strict";function n(e){return{view:"ssheet-suggest",css:"webix_ssheet_suggest",autowidth:!0,template:function(e){var t="";return e.icon&&(t+="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+e.icon+"'></span> "),t+=e.value||webix.i18n.spreadsheet.menus[e.id]||e.id},data:e,on:{onItemClick:function(e){var t=this.config.master;if(t){var n=webix.$$(t).getTopParentView(),o=[this.getItem(e)];if(webix.$$(t).config.area){var i=n.$$("cells").getSelectArea();i&&(o=o.concat([i.start,i.end]))}n.callEvent("onCommand",o)}}}}}webix.protoUI({name:"ssheet-button",$cssName:"button",defaults:{type:"htmlbutton",width:40},$init:function(e){if(this.$view.className+=" webix_ssheet_button",e.label||e.icon){var t=(e.icon||e.name).replace("-","_"),o=e.label||"";e.arrow&&(o+="<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow fa fa-angle-down'></span>"),e.label="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+t+"'></span> "+o,e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||""}e.options&&!e.popup&&(e.popup=n(e.options))}},webix.ui.button),webix.protoUI({name:"ssheet-button-icon-top",$cssName:"button",defaults:{type:"htmlbutton",width:70,height:70},$init:function(e){if(this.$view.className+=" ssheet_button_icon_top",e.label){var t=(e.icon||e.name||"").replace("-","_"),o=e.label;e.label="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+t+"'></span><br/>",e.label+="<span class='ssheet_button_icon_top_text'>"+o+"</span>",e.arrow&&(e.label+="<br/><span class='ssheet_button_icon_top_arrow fa fa-angle-down'></span>"),e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||""}e.options&&!e.popup&&(e.popup=n(e.options))}},webix.ui.button)},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};webix.protoUI({name:"multicheckbox",defaults:{padding:0,type:"clean",borderless:!0,elementsConfig:{labelWidth:10}},$init:function(e){e.rows=[{height:1e-6}],this.$ready.push(function(){this._initOnChange(),this.setValue(e.value)})},_initOnChange:function(){this.attachEvent("onChange",function(e){if(this.blockEvent(),"$all"===this.$eventSource.config.name){for(var t in this.elements)this.elements[t].setValue(e);this.getChildViews()[0].getBody().getChildViews()[0].setValue(1)}else{var n=this.getValue().length;n===this._count&&this.elements.$all.setValue(1),n<this._count&&this.elements.$all.setValue(0),0===n&&this.elements[this._findNext(this.$eventSource.config.name)].setValue(1)}this.unblockEvent()})},_findNext:function(e){for(var t in this.elements)if(t!==e&&"$all"!==t)return t},setValue:function(e){var t=[];for(var o in e)t.push(o);if(e=e||{},this.elements={},this._count=t.length,"object"===("undefined"==typeof e?"undefined":n(e))&&t.length){var i=[],r=[],a=400;for(var s in e)r.push({view:"checkbox",labelRight:s,name:s});var l=r.length*webix.skin.$active.inputHeight;i.push({view:"scrollview",body:{rows:r},scroll:l>a,height:l>a?a:l}),i.push({template:"<div class='ss_sep_line'></div>",height:10}),i.push({view:"checkbox",labelRight:webix.i18n.spreadsheet.labels["export-all-sheets"],name:"$all"}),webix.ui(i,this);for(var u in e)e[u]&&this.elements[u].setValue(e[u])}else this.getChildViews().length>1&&webix.ui([{height:1e-6}],this)},getValue:function(){var e=this.getValues(),t=[];for(var n in e)e[n]&&"$all"!==n&&t.push(n);return t}},webix.ui.form)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e.attachEvent("onComponentInit",function(){return r(e)});var t=[];if(e.config.toolbar){var n=e.config.toolbar;"full"==n&&(n=c.getAllElements(),webix.isUndefined(e.config.bottombar)&&(e.config.bottombar=!0)),t=l.ui.toolbarElements(e,n)}else t=l.ui.getButtons(e,e.config.buttons||f);var o={view:"toolbar",css:"webix_ssheet_toolbar webix_layout_toolbar",id:"bar",padding:0,elements:t,on:{onChange:function(){var t=this.$eventSource,n=t.getValue(),o=t.config.name;e.callEvent("onStyleSet",[o,n])},onItemClick:function(t){var n=e.innerId(t);s.actions[n]?s.actions[n].call(this,e):e.callEvent("onCommand",[{id:n}])}}};return e.callEvent("onViewInit",["toolbar",o]),o}function r(e){e.attachEvent("onAfterSelect",function(t){return a(e,t)})}function a(e,t){var n={},o=t[0];if(o){var i=e.getStyle(o.row,o.column);i&&(n=i.props)}webix.extend(n,l.defaultStyles),e.$$("bar").setValues(n)}t.__esModule=!0,t.init=i;var s=n(31),l=n(32),u=n(35),c=o(u),f={"undo-redo":["undo","redo"],font:["font-family","font-size","font-weight","font-style","text-decoration","color","background","borders"],align:["text-align","vertical-align","wrap","span"],format:["format"]}},function(e,t){"use strict";function n(e,t){var n,o,i=t.start,r=t.end;for(n=1*i.row;n<=1*r.row;n++)for(o=1*i.column;o<=1*r.column;o++)if(e.$$("cells").getSpan(n,o))return!0;return!1}t.__esModule=!0;t.actions={span:function(e){var t=e.$$("cells").getSelectArea();if(t)if(n(e,t))e.splitCell();else{for(var o=[],i=t.start.row;i<=t.end.row;i++){for(var r=t.start.column;r<=t.end.column;r++){var a=e.getCellValue(i,r);if(a&&o.push(a),o.length>1)break}if(o.length>1)break}o.length>1?e.confirm({text:webix.i18n.spreadsheet.labels["merge-cell-confirm"],callback:function(t){t&&e.combineCells()}}):e.combineCells()}},undo:function(e){e.undo()},redo:function(e){e.redo()},"hide-gridlines":function(e){e.hideGridlines("toggle")},"hide-headers":function(e){e.hideHeaders("toggle")},"freeze-columns":function(e){var t=e.$$("cells"),n=t.getSelectedId();e.freezeColumns(n&&"rowId"!=n.column?n.column:0)},"freeze-rows":function(e){var t=e.$$("cells"),n=t.getSelectedId();e.freezeRows(n?n.row:0)},"clear-data":function(e){e.clearRange()}}},function(e,t,n){"use strict";t.__esModule=!0,t.ui=t.defaultStyles=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(33),r={height:39,margin:7,paddingY:1,sectorPadding:5,sectorMargin:0},a=[{id:"no",value:"no"},{id:"left",value:"left"},{id:"top",value:"top"},{id:"right",value:"right"},{id:"bottom",value:"bottom"},{id:"all",value:"all"},{id:"outer",value:"outer"},{id:"top-bottom",value:"top_bottom"}],s=t.defaultStyles={color:"#666666",background:"#ffffff","font-family":"'PT Sans', Tahoma","font-size":"15px","text-align":"left","vertical-align":"top","white-space":"nowrap",borders:["no","#434343"]},l=t.ui={toolbarElements:function(e,t){var n=function o(t){for(var n=0;n<t.length;n++){var r=t[n].$button;if(r){var a=i.buttonsMap[r]?i.buttonsMap[r](e):l.iconButton({name:r});webix.extend(t[n],a)}t[n].rows&&o(t[n].rows),t[n].cols&&o(t[n].cols)}};return n(t),t},getButtons:function(e,t){var n=[];for(var o in t)n.push(l.elementsBlock(e,o,t[o])),n.push(l.separator());return n},elementsBlock:function(e,t,n){var o={rows:[{padding:2,cols:[{height:r.height,margin:2,cols:l.blockColumns(e,n)}]},l.title({title:t})]};return o},blockColumns:function(e,t){for(var n=[],r=0;r<t.length;r++){var a=t[r];if("object"==("undefined"==typeof a?"undefined":o(a)))n.push(a);else{var s=i.buttonsMap[a]?i.buttonsMap[a](e):l.iconButton({name:a});n.push(s)}}return n},button:function(e){return{view:"ssheet-toggle",width:e.width||40,id:e.name,name:e.name,label:e.label,css:e.css||"",onValue:e.onValue,offValue:e.offValue,tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},colorButton:function(e){return{view:"ssheet-color",css:e.css,name:e.name,width:e.width||62,title:"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon_"+e.name.replace(/-/g,"_")+"' ></span>",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},iconButton:function(e){var t=webix.copy(e);return webix.extend(t,{view:"button",type:"htmlbutton",width:40,id:e.name,label:"<span class='webix_ssheet_button_icon webix_ssheet_icon_"+e.name.replace(/-/g,"_")+"'></span>",css:"",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||webix.i18n.spreadsheet.menus[e.name]||""}),e.onValue&&webix.extend(t,{view:"ssheet-toggle",onValue:e.onValue,offValue:e.offValue},!0),t},segmented:function(e){return{view:"segmented",name:e.name,css:e.css||"",width:e.width||115,options:e.options}},select:function(e){return webix.extend(e,{view:"richselect",id:e.name,value:s[e.name],suggest:{css:"webix_ssheet_suggest",padding:0,data:e.options}}),e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||"",e.popupWidth&&(e.suggest.fitMaster=!1,e.suggest.width=e.popupWidth),e.popupTemplate&&(e.suggest.body={template:e.popupTemplate}),e},separator:function(){return{view:"ssheet-separator"}},title:function u(e){var u=e.title;return 0===u.indexOf("$")&&(u=""),u=webix.i18n.spreadsheet.labels[e.title]||u,{template:u,view:"ssheet-bar-title",height:24}},borders:function(e){return{view:"ssheet-borders",width:e.width||62,data:a,id:e.name,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},align:function(e){return{view:"ssheet-align",value:s[e.name],width:e.width||62,data:e.options,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},condFormat:function(e){return{view:"ssheet-cond-format",width:40,id:e.name,name:e.name}}}},function(e,t,n){"use strict";function o(){var e=webix.i18n.spreadsheet.labels;return[{id:"-1",value:e.common},{id:"price",value:e.currency,example:"98.20"},{id:"int",value:e.number,example:"2120.02"},{id:"percent",value:e.percent,example:"0.5"}]}function i(){var e=webix.i18n.spreadsheet.menus;return[{id:"add",group:"column",value:e["insert-column"]},{id:"del",group:"column",value:e["delete-column"]},{id:"show",group:"column",value:e["show-column"]},{id:"hide",group:"column",value:e["hide-column"]}]}function r(){var e=webix.i18n.spreadsheet.menus;return[{id:"add",group:"row",value:e["insert-row"]},{id:"del",group:"row",value:e["delete-row"]},{id:"show",group:"row",value:e["show-row"]},{id:"hide",group:"row",value:e["hide-row"]}]}function a(){for(var e=["8","9","10","11","12","14","15","16","18","20","22","24","28","36"],t=[],n=0;n<e.length;n++)t.push({id:e[n]+webix.i18n.spreadsheet.labels.px,value:e[n]});return t}t.__esModule=!0,t.buttonsMap=t.fontFamily=void 0;var s=n(32),l=n(34),u=[{id:"Arial",value:"Arial"},{id:"'PT Sans', Tahoma",value:"PT Sans"},{id:"Tahoma",value:"Tahoma"},{id:"Verdana",value:"Verdana"},{id:"Calibri, Tahoma",value:"Calibri"}];t.fontFamily=u;t.buttonsMap={"font-family":function(){return s.ui.select({name:"font-family",tooltip:"Font family",options:u,width:100})},"font-size":function(){return s.ui.select({name:"font-size",tooltip:"Font size",options:a(),width:62})},"font-weight":function(){return s.ui.button({name:"font-weight",label:"B",css:"webix_ssheet_bold",tooltip:"Bold",onValue:"bold",offValue:"normal"})},"font-style":function(){return s.ui.button({name:"font-style",label:"I",css:"webix_ssheet_italic",tooltip:"Italic",onValue:"italic",offValue:"normal"})},"text-decoration":function(){return s.ui.button({name:"text-decoration",label:"U",css:"webix_ssheet_underline",tooltip:"Underline",onValue:"underline",offValue:"normal"})},color:function(){return s.ui.colorButton({name:"color",icon:"font",css:"webix_ssheet_color"})},background:function(){return s.ui.colorButton({name:"background",icon:"paint-brush",css:"webix_ssheet_background"})},borders:function(){return s.ui.borders({name:"borders"})},"text-align":function(){var e=webix.i18n.spreadsheet.tooltips;return s.ui.align({name:"text-align",tooltip:"Horizontal Align",css:"webix_ssheet_align",options:[{id:"left",css:"webix_ssheet_icon_left",tooltip:e["align-left"]},{id:"center",css:"webix_ssheet_icon_center",tooltip:e["align-center"]},{id:"right",css:"webix_ssheet_icon_right",tooltip:e["align-right"]}]})},"vertical-align":function(){var e=webix.i18n.spreadsheet.tooltips;return s.ui.align({name:"vertical-align",tooltip:"Vertical Align",css:"webix_ssheet_align",options:[{id:"top",css:"webix_ssheet_icon_top",tooltip:e["align-top"]},{id:"middle",css:"webix_ssheet_icon_middle",tooltip:e["align-middle"]},{id:"bottom",css:"webix_ssheet_icon_bottom",tooltip:e["align-bottom"]}]})},wrap:function(){return s.ui.iconButton({name:"wrap",onValue:"wrap",offValue:"nowrap"})},format:function(){return s.ui.select({name:"format",tooltip:"Cell data format",options:o(),width:100,popupWidth:180,popupTemplate:function(e){var t=l.formatHelpers[e.id],n={css:""},o=t?t(e.example,n):"";return e.value+(t?"<span class='webix_ssheet_right"+(n.css?" "+n.css:"")+"'>"+o+"</span>":"")}})},column:function(){return{name:"column",view:"ssheet-button",icon:"column",arrow:!0,area:!0,width:55,options:i()}},row:function(){return{name:"row",view:"ssheet-button",icon:"row",arrow:!0,area:!0,width:55,options:r()}}}},function(e,t){"use strict";function n(e,t){var n,o=[];for(n in v)o.push([n,v[n]]);t.formats=o}function o(e,t){var n,o=t.formats;if(o)for(n=0;n<o.length;n++)a(o[n][1],o[n][0])}function i(e){return p[e]}function r(e){return v[e]||""}function a(e,t){return g[e]?g[e]:(t=t||"fmt"+h++,d[t]=e,p[t]=l(e),v[t]=e,g[e]=t,t)}function s(e){var t=e.match(/.*\[[><=].*/g),n=e.split(";");return t||n.length>1&&(n[0]=(n.length>2?"[>=0]":"[>0]")+n[0],n[1]="[<0]"+n[0],n[2]&&(n[2]="[=0]"+n[0])),n}function l(e){for(var t=s(e),n=[],o=0;o<t.length;o++){var i="",r="",a=t[o],l=a.indexOf("[");if(l!==-1&&a[1].match(/[><=]/)){var c=a.indexOf("]");i=a.substr(l+1,c-l-1),a=a.substr(c+1)}if(l=a.indexOf("["),l!==-1){var f=a.indexOf("]");r=a.substr(l+1,f-l-1),a=a.substr(f+1)}n.push(u(i,r,a,o))}return new Function("val","extra",n.join("\n")+" return val;")}function u(e,t,n,o){var i="";return e&&(i+=o?"else if":"if","="===e[0]&&(e="="+e),i+="(val"+e+"){ "),t&&(i+='extra.css = "webix_ssheet_format_'+t+'";'),
i+=c(n),i+(e?"}":"")}function c(e){if(!e)return"return val;";for(var t=0,n='return ""',o="",i=!1,r=!1,a=0;a<e.length;a++){if('"'==e[a]){if(t){n+='+"'+e.substr(t,a-t)+'"',t=!1;continue}t=a}t||("."===e[a]?o+=".":"0"===e[a]||"#"===e[a]||"?"===e[a]?(r||(n+="+fmt",r=!0),o+=e[a]):","===e[a]?i=!0:n+='+"'+e[a]+'"')}return o?f(o,i)+";"+n+";":n+";"}function f(e,t){var n="if (isNaN(val)) var fmt = val; else {",o=e.split("."),i=o[0],r=o[1];r=(r||"").split("").reverse().join("");var a=i.indexOf("0");a>=0&&(a=i.length-a);var s=i.indexOf("?");s>=0&&(s=i.length-s);var l=r.indexOf("0");l>=0&&(l=r.length-l);var u=Math.max(l,r.length),c=r.indexOf("?");return c>=0&&(c=r.length-c),n+="\n\tvar decimal = '.';\n\tvar parts = val.toFixed("+u+').split(decimal);\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || "";\n\tif (left.length < '+a+') left = "0000000000".substr(0, '+a+" - left.length)+left;\n\tif (left.length < "+s+') left = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".substr(0, 6*('+s+" - left.length))+left;\n\tif ("+t+') { \n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tbuf.push(left.substr(0,left.length-start+3)); \n\t\tleft = buf.reverse().join(",");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length; for (var i=right.length-1; i>=0; i--) if (right[i]!="0"){ zpoint = right.length-i; break; }\n\t\n\t\tif (zpoint >  '+l+")\n\t\t\tright = right.substr(0,"+l+");\n\t\tif (right.length < "+c+') left += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".substr(0, 6*('+c+' - left.length));\n\t}\n\tvar fmt = left+(right?decimal:"")+right;',n+"}\n"}t.__esModule=!0,t.serialize=n,t.load=o,t.getFormat=i,t.getFormatSource=r,t.addFormat=a;var d={},h=0,p=t.formatHelpers={price:function(e,t){return t.css="webix_ssheet_format_price",webix.i18n.priceFormat(e)},"int":function(e,t){return t.css="webix_ssheet_format_int",webix.i18n.numberFormat(e)},percent:function(e,t){return t.css="webix_ssheet_format_percent",Math.round(100*e)+"%"}},v={},g={}},function(e,t){"use strict";function n(e){var t=webix.i18n.spreadsheet;return t.menus[e]||t.labels[e]||t.tooltips[e]||e}function o(){var e,t,o,i={undo:["undo","redo"],insert:["add-sparkline","add-image"]},r={};for(t in i)for(r[t]=0,e=0;e<i[t].length;e++)o=webix.html.getTextSize(n(i[t][e]),"webix_ssheet_button_measure").width+2,r[t]=Math.max(o,r[t]);return r}function i(){var e=o();return[{padding:3,margin:0,rows:[{margin:2,cols:[{name:"sheet",view:"ssheet-button-icon-top",label:n("sheet"),arrow:!0,options:[{id:"new-sheet"},{id:"copy-sheet"},{id:"remove-sheet"}]},{rows:[{$button:"excel-import"},{$button:"excel-export"}]},{rows:[{$button:"print"}]}]},{},{template:n("file"),view:"ssheet-bar-title",height:24,width:85}]},{view:"ssheet-separator"},{padding:3,rows:[{$button:"undo",view:"ssheet-button",label:n("undo"),width:e.undo},{$button:"redo",view:"ssheet-button",label:n("redo"),width:e.undo},{template:n("undo-redo"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{margin:2,cols:[{margin:2,cols:[{$button:"font-family",width:124},{$button:"font-size"}]},{$button:"borders"}]},{margin:2,cols:[{margin:2,cols:[{$button:"font-weight"},{$button:"font-style"},{$button:"text-decoration"}]},{$button:"background"},{$button:"color"}]},{template:n("font"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{margin:2,cols:[{$button:"text-align"},{$button:"span"}]},{margin:2,cols:[{$button:"vertical-align"},{$button:"wrap"}]},{template:n("align"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{$button:"format"},{$button:"custom-format"},{template:n("number"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{cols:[{$button:"sort-asc"},{$button:"create-filter"},{$button:"conditional-format"},{$button:"add-link"},{$button:"clear-styles"}]},{cols:[{$button:"sort-desc"},{$button:"add-range"},{$button:"lock-cell"},{$button:"add-dropdown"}]},{template:n("edit"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{$button:"add-image",view:"ssheet-button",label:n("image"),width:e.insert},{$button:"add-sparkline",view:"ssheet-button",label:n("graph"),width:e.insert},{template:n("insert"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{cols:[{rows:[{$button:"row"},{$button:"column"}]},{rows:[{$button:"hide-gridlines"},{$button:"hide-headers"}]},{rows:[{$button:"freeze-rows"},{$button:"freeze-columns"}]}]},{template:n("view"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{}]}t.__esModule=!0,t.getAllElements=i},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){e.attachEvent("onComponentInit",function(){return r(e)});var n={view:"datatable",id:"cells",css:"webix_ssheet_table wss_"+e.$index,headerRowHeight:20,spans:!0,leftSplit:1,areaselect:!0,editable:!0,editaction:t.liveEditor?"custom":"dblclick",navigation:!0};return"undefined"==typeof t.clipboard&&(t.clipboard=!0),t&&(n=webix.extend(n,t,!0)),n}function r(e){var t=e._table;e.config.math&&(t.config.editMath=!0),t.attachEvent("onBeforeEditStop",function(n,o){n.old===webix.undefined&&""===n.value||(n.value!=n.old&&(e.setCellValue(o.row,o.column,n.value),t.refresh()),n.value=n.old)});var n=void 0;t.$view.firstChild.addEventListener("mousedown",function(e){n=e.target.parentNode.cellIndex+1}),t.$view.firstChild.addEventListener("mouseup",function(t){var o=t.target.parentNode.cellIndex+1;n&&n!==o&&(c.selectColumn(n,e,o),n=void 0)}),t.attachEvent("onEnter",function(){t.getEditor()&&webix.delay(function(){t.moveSelection("down")})}),e.attachEvent("onBeforeEditStart",function(t,n){return!e.isCellLocked(t,n)}),t.attachEvent("onBeforeEditStart",function(t){return e.callEvent("onBeforeEditStart",[t.row,t.column])}),t.attachEvent("onBeforeSelect",function(e){return"rowId"!=e.column}),t.attachEvent("onBeforeBlockSelect",function(t,n,o){return!o||"rowId"===t.column&&"rowId"===n.column||("rowId"===t.column&&(t.column=1),"rowId"===n.column&&(n.column=1)),("rowId"!==t.column||"rowId"!==n.column)&&(c.highlightColRow(t,n,e),!0)}),t.attachEvent("onSelectChange",function(){var n=t.getSelectedId(!0);if(n.length){var o=n[0],i=n[n.length-1]?n[n.length-1]:n[0];c.highlightColRow(o,i,e)}else{var r={row:0,column:0};c.highlightColRow(r,r,e)}}),t.attachEvent("onItemDblClick",function(t){"rowId"===t.column&&c.adjustRow(t.row,e)});var o=0;t.attachEvent("onHeaderClick",function(t,n){var i=new Date,r=i-o<=300;r?c.adjustColumn(t.column,e):(o=i,n.shiftKey?c.selectColumns(t.column,e):c.selectColumn(t.column,e))});var i=null;t.attachEvent("onItemClick",function(t,n){"rowId"===t.column&&(n.shiftKey&&i?c.selectRow(i,e,t.row):c.selectRow(t.row,e),i=t.row)}),e.attachEvent("onReset",function(){return s(e)}),t.attachEvent("onBlur",function(){webix.delay(function(){var n=document.activeElement;if(!n||"INPUT"!=n.tagName){var o=webix.UIManager.getFocus(),i=o&&o!=t&&o.getTopParentView&&o.getTopParentView()===e;i&&webix.UIManager.setFocus(t)}},this,[],100)}),l(e)}function a(e,t,n,o,i){var r=t.$cellFormat?t.$cellFormat[i.id]:null;if(r){var a={css:""},s=p.getFormat(r);if(s){var l=parseFloat(o);if(!isNaN(l)){var u=s(l,a);return a.css?"<div class='"+a.css+"'>"+u+"</div>":u}}}return o}function s(e){var t=e.$$("cells");t.clearAll();for(var n=e.config.columnCount,o=e.config.rowCount,i=[{id:"rowId",header:"",width:40,css:"sheet_column_0",template:function(e){return e.id}}],r=1;r<=n;r++)i.push({id:r,editor:"text",header:{text:d.encode[r],css:e._hideColumn&&e._hideColumn.indexOf(r+1)>=0?"webix_ssheet_hide_column":""},template:function(t,n,o,i){return a(e,t,n,o,i)}}),e.callEvent("onColumnInit",[i[r]]);t.refreshColumns(i),e._hideColumn&&e._hideColumn.length&&e._hideColumn.map(function(e){return t.hideColumn(e)});for(var s=[],l=1;l<=o;l++)s.push({id:l});t.parse(s),e._hideRow&&e._hideRow.length&&t.filter(function(t){if(e._hideRow.indexOf(t.id)===-1)return!0;if(t.id-1===0){var n=e.$$("cells").getColumnConfig("rowId").header[0];n.css=(n.css||"")+" webix_ssheet_hide_row",e.$$("cells").refreshColumns()}else e.$$("cells").addCellCss(t.id-1,"rowId","webix_ssheet_hide_row");return!1})}function l(e){webix.html.addStyle("#"+e._table.$view.id+".webix_dtable .webix_cell { white-space:nowrap;}")}t.__esModule=!0,t.init=i,t.reset=s;var u=n(37),c=o(u),f=n(41),d=o(f),h=n(34),p=o(h)},function(e,t,n){"use strict";function o(e,t,n){var o={row:e,column:1},i={row:n||e,column:t.config.columnCount};u(o,i,t)}function i(e,t,n){var o=t.$$("cells").data.order[0],i=t.$$("cells").data.order.length,r={row:o,column:e},a={row:i,column:n||e};u(r,a,t)}function r(e,t){var n=t.$$("cells").getSelectArea();return!!(n&&e>=n.start.column&&e<=n.end.column)}function a(e,t,n){return s(e,n)&&r(t,n)}function s(e,t){var n=t.$$("cells").getSelectArea();return!!(n&&e>=n.start.row&&e<=n.end.row)}function l(e,t){var n=t.$$("cells").getSelectArea();if(n){var o=Math.min(n.start.column,n.end.column,e),r=Math.max(n.start.column,n.end.column,e);i(o,t,r)}else i(e,t)}function u(e,t,n){n.$$("cells").addSelectArea(e,t)}function c(e,t){var n=25;t._table.eachRow(function(o){var i=this.getItem(o),r=this.getText(o,e),a=t.getStyle(o,e),s=a?a.id:"";if(r){var l=(0,h.getTextSize)(t,r,s,0,i.$height);l.width>n&&(n=l.width)}}),t._table.setColumnWidth(e,n)}function f(e,t){var n=25;t._table.eachColumn(function(o){var i=this.getText(e,o),r=t.getStyle(e,o),a=r?r.id:"";if(i){var s=(0,h.getTextSize)(t,i,a,this.getColumnConfig(o).width,0);s.height>n&&(n=s.height)}}),t._table.setRowHeight(e,n)}function d(e,t,n){if(n._table.config.header){var o=e.row,i=t.row,r=e.column,a=t.column;if(i<o){var s=[i,o];o=s[0],i=s[1]}if(a<r){var l=[a,r];r=l[0],a=l[1]}n._table.eachRow(function(e){e>=o&&e<=i?n._table.addCellCss(e,"rowId","webix_highlight"):n._table.removeCellCss(e,"rowId","webix_highlight")}),n._table.eachColumn(function(e){var t=n._table.getHeaderNode(e);t&&(e>=r&&e<=a?webix.html.addCss(t,"webix_highlight"):webix.html.removeCss(t,"webix_highlight"))})}}t.__esModule=!0,t.selectRow=o,t.selectColumn=i,t.isColSelected=r,t.isCellSelected=a,t.isRowSelected=s,t.selectColumns=l,t.adjustColumn=c,t.adjustRow=f,t.highlightColRow=d;var h=n(38)},function(e,t,n){"use strict";function o(e){e.attachEvent("onStyleSet",function(t,n){return c(e,t,n)}),e.attachEvent("onDataParse",function(t){return u(e,t)}),e.attachEvent("onDataSerialize",function(t){return s(e,t)}),e.attachEvent("onReset",function(){return i(e)}),e.attachEvent("onUndo",function(t,n,o,i){"style"==t&&a(e,n,o,i)}),e.attachEvent("onCommand",function(t){"clear-styles"==t.id&&e.clearRange(null,{styles:!0})}),i(e),$||($=webix.html.create("DIV",{style:"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;"},""))}function i(e){e._styles={},e._styles_cache={},e._styles_max=1;var t=".wss_"+e.$index;webix.html.removeStyle(t)}function r(e,t){var n=e.getRow(t.row).$cellCss;if(n){var o=n[t.column];if(o)return e._styles[o]}return null}function a(e,t,n,o){var i={row:t,column:n};p(e,i,o)}function s(e,t){var n=[];for(var o in e._styles_cache)n.push([e._styles_cache[o].id,o]);t.styles=n}function l(e,t,n){var o={props:y(";;;;;;;;;;;;;;;")};if(n)for(var i in n.props)o.props[i]=n.props[i];for(var r in t)o.props[r]=t[r];o.text=_(o);var a=e._styles_cache[o.text];return a?a:(b(e,o),o)}function u(e,t){if(t.styles)for(var n=0;n<t.styles.length;n++){var o=t.styles[n],i={id:o[0],text:o[1],props:y(o[1])};b(e,i,!0)}for(var r=0;r<t.data.length;r++){var a=t.data[r],s=a[0],l=a[1],u=a[3];u&&h(e.getRow(s),l,e._styles[u])}}function c(e,t,n){S.group.set(function(){e.eachSelectedCell(function(o){f(e,o,t,n)})}),e.refresh()}function f(e,t,n,o){var i=r(e,t),a=d(e,i,n,o,t);a&&a!=i&&w(e,t,a,i)}function d(e,t,n,o,i){if(M[n])return M[n](e,t,o,i);if(t&&t.props[n]==o)return t;var r={text:"",id:0,props:t?webix.copy(t.props):{}};r.props[n]=o,r.text=_(r);var a=e._styles_cache[r.text];return a?a:(b(e,r),r)}function h(e,t,n){e.$cellCss=e.$cellCss||{},e.$cellFormat=e.$cellFormat||{},n?(e.$cellCss[t]=n.id,e.$cellFormat[t]=n.props.format||null):(delete e.$cellCss[t],delete e.$cellFormat[t])}function p(e,t,n){var o=r(e,t);return w(e,t,n,o)}function v(e,t,n){(0,E.eachRange)(t,e,w,n)}function g(e,t,n,o,i){var r=0,a=0;return $.innerHTML=t,$.style.width=(o||1)+"px",$.style.height=(i||1)+"px",$.className="webix_table_cell webix_cell "+n,e._table.$view.appendChild($),r=Math.max(r,$.scrollWidth),a=Math.max(a,$.scrollHeight),e._table.$view.removeChild($),$.innerHTML="",{width:r,height:a}}function w(e,t,n,o){e.callEvent("onBeforeStyleChange",[t.row,t.column,n,o])&&(h(e.getRow(t.row),t.column,n),e.saveCell(t.row,t.column),e.callEvent("onStyleChange",[t.row,t.column,n,o]))}function m(e){var t="";for(var n in e)e[n]&&(k[n]?k[n][e[n]]?t+=k[n][e[n]](e):"function"==typeof k[n]&&(t+=k[n](e)):t+=n+":"+e[n]+";");return t}function b(e,t,n){for(e._styles_cache[t.text]=t;!t.id||e._styles[t.id];)t.id="wss"+e._styles_max++;e._styles[t.id]=t;var o=m(t.props),i=".wss_"+e.$index;webix.html.addStyle(i+" ."+t.id+"{"+o+"}",i),n||e._save("styles",{name:t.id,text:t.text})}function _(e){for(var t=[],n=0;n<V.length;n++)t.push(e.props[V[n]]);return t.join(";")}function y(e){for(var t=e.split(";"),n={},o=0;o<V.length;o++)n[V[o]]=t[o];return n}function x(e,t){S.group.set(function(){(0,E.eachRange)(t,e,function(e,t){var n=r(e,t);n&&p(e,t,null),e.callEvent("onClearStyle",[t.row,t.column])})})}function C(e){for(var t=e.serialize(),n=t.data,o=t.styles,r={},a=0;a<n.length;a++){var s=n[a][3];s&&(r[s]=1)}for(var l=[],c=0;c<o.length;c++){var f=o[c][0];r[f]&&l.push(o[c])}t.styles=l,i(e),u(e,t)}t.__esModule=!0,t.style_names=void 0,t.init=o,t.getStyle=r,t.addStyle=l,t.setStyle=p,t.setRangeStyle=v,t.getTextSize=g,t.clearRangeStyle=x,t.compactStyles=C;var $,S=n(39),E=n(41),V=t.style_names=["color","background","text-align","font-family","font-size","font-style","text-decoration","font-weight","vertical-align","wrap","borders","format","border-right","border-bottom","border-left","border-top"],k={"vertical-align":{top:function(){return"display: block;"},middle:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items: center;justify-content:"+t+";";return n},bottom:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items:flex-end;justify-content:"+t+";";return n}},wrap:{wrap:function(){return"white-space: normal !important; line-height:normal !important; padding-top:7px;padding-bottom:7px;"},nowrap:function(){return""}},format:"",borders:"","border-left":function(e){return e["border-left"]?"border-left: 1px solid "+e["border-left"]+" !important;":""},"border-top":function(e){return e["border-top"]?"border-top: 1px solid "+e["border-top"]+" !important;":""},"border-right":function(e){return e["border-right"]?"border-right: 1px solid "+e["border-right"]+" !important;":""},"border-bottom":function(e){return e["border-bottom"]?"border-bottom: 1px solid "+e["border-bottom"]+" !important;":""}},R={"border-left":function(e,t,n){return e.column==t.start.column||"no"==n},"border-right":function(e,t,n){return e.column==t.end.column||"all"==n||"no"==n},"border-top":function(e,t,n){return e.row==t.start.row||"no"==n},"border-bottom":function(e,t,n){return e.row==t.end.row||"all"==n||"no"==n}},M={borders:function(e,t,n,o){var i=e.$$("cells").getSelectArea();n=n.split(",");var r=n[0],a=n[1],s=["border-left","border-right","border-bottom","border-top"];"no"==r?a="":"top-bottom"==r?s=["border-top","border-bottom"]:"all"!=r&&"outer"!=r&&(s=["border-"+r]);for(var l=0;l<s.length;l++){var u=s[l],c=e.callEvent("onAction",["check-borders",{row:o.row,column:o.column,area:i,type:r,mode:u}]);(c===!0||R[u](o,i,r))&&(t=d(e,t,u,a,o))}return t}}},function(e,t,n){"use strict";function o(e){a(e),f(e),e.attachEvent("onHardReset",function(){return a(e)}),e.attachEvent("onAfterSheetShow",function(){return a(e)}),e.attachEvent("onBeforeStyleChange",function(t,n,o,i){return!(0,d.isCellLocked)(e,t,n)&&void s(e,{action:"style",row:t,column:n,value:i,newValue:o,group:h.value})}),e.attachEvent("onBeforeValueChange",function(t,n,o,i){return!(0,d.isCellLocked)(e,t,n)&&void s(e,{action:"value",row:t,column:n,value:i,newValue:o,group:h.value})}),e.attachEvent("onBeforeSpan",function(t,n,o){return!(0,d.isCellLocked)(e,t,n)&&void s(e,{action:"span",row:t,column:n,value:o,newValue:o,group:h.value})}),e.attachEvent("onBeforeSplit",function(t,n,o){return!(0,d.isCellLocked)(e,t,n)&&void s(e,{action:"split",row:t,column:n,value:o,newValue:o,group:h.value})}),e.attachEvent("onAction",function(t,n){return s(e,{action:t,row:n.row||null,column:n.column||null,value:n.value||null,newValue:n.newValue||null,group:h.value})}),e.$$("cells").attachEvent("onColumnResize",function(t,n,o){return s(e,{action:"c-resize",row:0,column:t,value:o,newValue:n})}),e.attachEvent("onColumnOperation",function(t,n,o){"add"!==t.id&&"del"!==t.id&&s(e,{action:t,row:0,column:{start:n,end:o}})}),e.attachEvent("onRowOperation",function(t,n,o){"add"!==t.id&&"del"!==t.id&&s(e,{action:t,row:{start:n,end:o},column:0})}),e.$$("cells").attachEvent("onRowResize",function(t,n,o){return s(e,{action:"r-resize",row:t,column:0,value:o,newValue:n})}),e.attachEvent("onBeforeConditionSet",function(t,n,o,i){return!(0,d.isCellLocked)(e,t,n)&&(o=o?webix.copy(o):null,void s(e,{action:"condition",row:t,column:n,value:o,newValue:i,group:h.value}))})}function i(e){c(e,-1)}function r(e){c(e,1)}function a(e){p||(e._ssUndoHistory=[],e._ssUndoCursor=-1)}function s(e,t){e.$skipHistory||(e._ssUndoHistory.splice(e._ssUndoCursor+1),e._ssUndoHistory.push(t),e._ssUndoCursor++)}function l(e,t){t.$skipHistory=!0,e(),t.$skipHistory=!1}function u(e){p=!0,e(),p=!1}function c(e,t){var n=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];if(n){var o=t>0?n.newValue:n.value,i=t>0,r=[n.action,n.row,n.column,o,i];e._ssUndoCursor+=t;var a=n.group,s=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];l(function(){e.callEvent("onUndo",r),a&&s&&a==s.group||e.refresh()},e),s&&a&&a==s.group&&c(e,t)}}function f(e){e.attachEvent("onUndo",function(t,n,o,i){switch(t){case"freeze-row":e.freezeRows(i);break;case"freeze-column":e.freezeColumns(i)}})}t.__esModule=!0,t.group=void 0,t.init=o,t.undo=i,t.redo=r,t.reset=a,t.ignoreUndo=l,t.ignoreReset=u;var d=n(40),h=t.group={value:null,set:function(e,t){this.value?e.call(t):(this.start(),e.call(t),this.end())},start:function(){this.value=webix.uid()},end:function(){this.value=null}},p=!1},function(e,t,n){"use strict";function o(e){e._locks={},e.attachEvent("onReset",function(){return i(e)}),e.attachEvent("onUndo",function(t,n,o,i){"lock"===t&&r(e,n,o,!!i,!0)}),e.attachEvent("onCommand",function(t){"lock-cell"===t.id&&c(e)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&f(t.name,t.inc,t.data,t.start)})}function i(e){e._locks={}}function r(e,t,n,o,i){var s=e.$$("cells");if("object"===("undefined"==typeof t?"undefined":d(t))&&"object"===("undefined"==typeof n?"undefined":d(n)))h.group.set(function(){a(t,n,function(t,n){r(e,t,n,o,!0)})});else{o=o!==!1;var l=e._locks[t]=e._locks[t]||{};l[n]=o,o?s.addCellCss(t,n,p,!0):s.removeCellCss(t,n,p,!0),e.callEvent("onAction",["lock",{row:t,column:n,value:!o,newValue:o}])}i||s.refresh()}function a(e,t,n,o){for(var i=e.row;i<=t.row;i++)for(var r=e.column;r<=t.column;r++)n.call(o||this,i,r)}function s(e,t,n){return!!e._locks[t]&&e._locks[t][n]}function l(e,t){var n,o,i=[];for(n in e._locks)for(o in e._locks[n])e._locks[n][o]&&i.push([n,o]);t.locked=i}function u(e,t){var n,o=t.locked;if(o)for(n=0;n<o.length;n++)r(e,o[n][0],o[n][1],!0,!0)}function c(e){var t=e.$$("cells").getSelectArea();if(t){var n=e.isCellLocked(t.start.row,t.start.column);e.lockCell(t.start,t.end,!n)}}function f(e,t,n,o){var i=n.locked,r=i.length;if(t)for(;r--;){var a=i[r],s=a[0],l=a[1];(s&&"row"==e&&s>=o.row||l&&"column"==e&&l>=o.column)&&("row"==e?s<o.row-t?i.splice(r,1):i[r][0]=1*s+t:"column"==e&&(l<o.column-t?i.splice(r,1):i[r][1]=1*l+t))}}t.__esModule=!0,t.lockCss=void 0;var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.init=o,t.lockCell=r,t.isCellLocked=s,t.serialize=l,t.load=u;var h=n(39),p=t.lockCss="webix_lock"},function(e,t){"use strict";function n(e){var t=e.charCodeAt(1)<59?1:2,n=e.substr(0,t),o=e.substr(t);return[1*o,d[n]]}function o(e,t){var o=e.indexOf("!"),i="";o!==-1&&(i=e.substr(0,o),"'"===i[0]&&(i=i.substr(1,i.length-2)),e=e.substr(o+1));var r=e.split(":");if(2!=r.length&&t){if(e=t.ranges.getCode(e,i),!e)return null;r=e.split(":")}var a=n(r[0]),s=n(r[1]);return[a[0],a[1],s[0],s[1],i]}function i(e){return m.test(e)?"'"+e+"'":e}function r(e,t,n,o,r){return(r?i(r)+"!":"")+h[t]+e+":"+h[o]+n}function a(e,t,n){return(n?i(n)+"!":"")+e+":"+t}function s(e,t){if("object"===("undefined"==typeof e?"undefined":f(e)))return e;var n=o(e,t);return{start:{row:n[0],column:n[1]},end:{row:n[2],column:n[3]},sheet:n[4]}}function l(e,t,n,o){for(var i=s(e),r=i.start.row;r<=i.end.row;r++)for(var a=i.start.column;a<=i.end.column;a++)n(t,{row:r,column:a},o)}function u(e){return b.test(e)}function c(e,t,n,i){var a=!1;if(u(e)){var s=o(e),l=s[0],c=s[1],f=s[2],d=s[3],h=s[4];"row"===t&&i.row<=f?(i.row<=l&&(l+=n),f+=n,a=!0):"column"===t&&i.column<=d&&(i.column<=c&&(c+=n),d+=n,a=!0),a&&(e=r(l,c,f,d,h))}return e}t.__esModule=!0;var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.adress=n,t.range=o,t.toRange=r,t.toSheetRange=a,t.rangeObj=s,t.eachRange=l,t.isRange=u,t.changeRange=c;for(var d=t.decode={},h=t.encode={},p="ABCDEFGHIJKLMNOPQRSTUVWXYZ",v=1;v<1e3;v++){var g=parseInt((v-1)/p.length),w=(g?p[g-1]:"")+p[(v-1)%p.length];d[w]=v,h[v]=w}h[0]=h[1];var m=/[^A-Za-z0-9]/,b=/(([A-Za-z0-9]+|\'[^']+\'')\!|)[A-Z]+[0-9]+\:[A-Z]+[0-9]+/},function(e,t){"use strict";function n(e){var t=e.$$("cells");webix.UIManager.addHotKey("delete",function(){e.eachSelectedCell(function(t){return e.setCellValue(t.row,t.column,"")}),e.refresh()},t),webix.UIManager.addHotKey("any",function(e,n){if(16!=(n.which||n.keyCode)){var o=e.getSelectedId(!0);o.length&&t.config.editable&&(t.$anyKey=!0,t.edit(o[0]))}},t),webix.UIManager.addHotKey("enter",function(e){var n=e.getSelectedId(!0);n.length&&t.config.editable&&(e.config.liveEditor?t.callEvent("onBeforeLiveEditor",[n[0]]):t.edit(n[0]))},t),webix.UIManager.addHotKey("ctrl-z",function(){return e.undo()},t),webix.UIManager.addHotKey("ctrl-y",function(){return e.redo()},t),webix.UIManager.addHotKey("ctrl-b",function(){return r(e,"font-weight")},t),webix.UIManager.addHotKey("command-b",function(){return r(e,"font-weight")},t),webix.UIManager.addHotKey("ctrl-i",function(){return r(e,"font-style")},t),webix.UIManager.addHotKey("command-i",function(){return r(e,"font-style")},t),webix.UIManager.addHotKey("ctrl-u",function(t,n){return o(e,n)},t),webix.UIManager.addHotKey("command-u",function(t,n){return o(e,n)},t),webix.UIManager.addHotKey("ctrl-p",function(t,n){return i(e,n)},t),webix.UIManager.addHotKey("command-p",function(t,n){return i(e,n)},t)}function o(e,t){return r(e,"text-decoration"),webix.html.preventEvent(t)}function i(e,t){return e.callEvent("onCommand",[{id:"print"}]),webix.html.preventEvent(t)}function r(e,t){var n=e.getSelectedId();if(n){var o=e.getStyle(n.row,n.column),i=e.$$("bar").elements[t].data,r=i.onValue,a=i.offValue,s=o&&o.props[t]===r?a:r;e.callEvent("onStyleSet",[t,s])}}t.__esModule=!0,t.init=n},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e.attachEvent("onComponentInit",function(){return r(e)}),{view:"toolbar",css:"webix_ssheet_toolbar",elements:[{view:"label",template:"Edit: ",width:60},{view:"live-editor",disabled:!0,id:"liveEditor",suggestData:l}]}}function r(e){function t(e,t,n){var i=e.getColumnConfig(t.column).editor;return"text"!=i||(o(e,t,n),!1)}function n(t,n){return!(!e.getCellEditor(t,n)&&!e.isCellLocked(t,n))&&(a.setValue(""),a.disable(),!0)}function o(t,o,r){n(o.row,o.column)||(a.enable(),a.config.activeCell=o,a.setValue(r?"":e.getCellValue(o.row,o.column)),a.focus(),e.$handleSelection=function(e,n,o,r){return i(t,o,r,e)})}function i(e,t,n,o){if(t==n){if(!a.expectOperator())return r(o);a.setRange(t),webix.delay(function(){return a.focus()})}else{if(!a.expectRange())return r(o);a.setRange(t+":"+n),webix.delay(function(){return a.focus()})}return!1}function r(t){return a.isEnabled()&&(a.updateCellValue(),a.setValue(t?e.getCellValue(t.row,t.column):"")),!0}var a=e.$$("liveEditor");e._table.attachEvent("onBeforeEditStart",function(n){var o=e._table.$anyKey;return e._table.$anyKey=!1,t(this,n,o)}),e._table.attachEvent("onBeforeLiveEditor",function(e){t(this,e,!1)}),e._table.attachEvent("onItemDblClick",function(e){t(this,e,!1)}),e.attachEvent("onCellChange",function(e,t,n){var o=a.config.activeCell;o&&o.row==e&&o.column==t&&a.setValue(n)}),e.attachEvent("onAfterSelect",function(t){if(!e.$handleSelection){var n=t[0];o(e._table,n)}}),e.attachEvent("onReset",function(){return e.$handleSelection=null}),e.attachEvent("onAction",function(e,t){"lock"!=e&&"filter"!=e&&"dropdown"!=e||n(t.row,t.column)})}t.__esModule=!0,t.init=i;var a=n(44),s=o(a),l=[];for(var u in s.methods)"__esModule"!=u&&l.push(u)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){f[e]=t}t.__esModule=!0,t.methods=void 0,t.addMethod=i;var r=n(45),a=o(r),s=n(46),l=o(s),u=n(47),c=o(u),f=t.methods={};webix.extend(f,a),webix.extend(f,l),webix.extend(f,c)},function(e,t){"use strict";function n(e){return!(!e&&0!==e||(e=1*e,isNaN(e)))&&e}function o(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(t+=i)}return t}function i(e){for(var t=0,o=0,i=0;i<e.length;i++){var r=n(e[i]);r!==!1&&(t+=r,o++)}return t/o}function r(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&t++}return t}function a(e){for(var t=0,n=0;n<e.length;n++)e[n]&&1*e[n]!==0&&t++;return t}function s(e){for(var t=0,n=0;n<e.length;n++)1*!e[n]&&t++;return t}function l(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(i>t||""===t)&&(t=i)}return t||0}function u(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(i<t||""===t)&&(t=i)}return t||0}function c(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(t=""===t?i:t*i)}return t}function f(e){var t=e[0].length;for(var o in e)if(e[o].length!==t)return;for(var i=0,r=0;r<e[0].length;r++){var a="";for(var s in e){var l=n(e[s][r]);if(l===!1){a=0;break}a=""===a?l:a*l}webix.isUndefined(a)||(i+=a)}return i}function d(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);"number"==typeof i&&(t+=Math.pow(i,2))}return t}function h(e){for(var t=this.COUNT(e),o=this.AVERAGE(e),i=0,r=0;r<e.length;r++){var a=n(e[r]);a!==!1&&(i+=Math.pow(a-o,2))}return i/t}function p(e){return Math.sqrt(this.VARP(e))}function v(e,t){var o=n(e),i=n(t);if("number"==typeof o&&"number"==typeof i)return Math.pow(o,i)}function g(e,t){var o=n(e),i=n(t);if("number"==typeof o&&"number"==typeof i)return o/i}function w(e){var t=n(e);if(t!==!1&&t>=0)return Math.sqrt(t)}function m(e){var t=n(e);if(t!==!1)return Math.abs(t)}function b(){return Math.random()}function _(){return Math.PI}function y(e){var t=n(e);if(t!==!1)return Math.round(t)}function x(e,t){var o=n(e),i=n(t)||0;if(o!==!1)return parseFloat(o.toFixed(i))}function C(e,t){var o=n(e),i=n(t)||0;if(o!==!1)return Math.floor(o*Math.pow(10,i))/Math.pow(10,i)}function $(e,t){var o=n(e),i=n(t)||0;if(o!==!1)return Math.ceil(o*Math.pow(10,i))/Math.pow(10,i)}function S(e){var t=n(e);if(t!==!1)return parseInt(t)}function E(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o+1:o}}function V(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o:o+1}}t.__esModule=!0,t.SUM=o,t.AVERAGE=i,t.COUNT=r,t.COUNTA=a,t.COUNTBLANK=s,t.MAX=l,t.MIN=u,t.PRODUCT=c,t.SUMPRODUCT=f,t.SUMSQ=d,t.VARP=h,t.STDEVP=p,t.POWER=v,t.QUOTIENT=g,t.SQRT=w,t.ABS=m,t.RAND=b,t.PI=_,t.INT=y,t.ROUND=x,t.ROUNDDOWN=C,t.ROUNDUP=$,t.TRUNC=S,t.EVEN=E,t.ODD=V},function(e,t){"use strict";function n(){var e=Array.prototype.slice.call(arguments);return e=e.map(function(e){return"object"===("undefined"==typeof e?"undefined":f(e))?e.join(""):e}),e.join("")}function o(e,t){return e?e.substring(0,t):""}function i(e,t,n){return e?e.substring(t,t+n):""}function r(e,t){return e?e.substring(e.length-t):""}function a(e){return e?e.toLowerCase():""}function s(e){return e?e.toUpperCase():""}function l(e){if(!e)return"";var t=e.toLowerCase().split(" ");e="";for(var n in t)e+=(e?" ":"")+t[n].substring(0,1).toUpperCase()+t[n].substring(1);return e}function u(e){return e?e.trim():""}function c(e){return e||0===e?e.toString().length:0}t.__esModule=!0;var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.CONCATENATE=n,t.LEFT=o,t.MID=i,t.RIGHT=r,t.LOWER=a,t.UPPER=s,t.PROPER=l,t.TRIM=u,t.LEN=c},function(e,t){"use strict";function n(e){return'<img class="webix_ssheet_cimage" src="'+e+'">'}function o(e,t,n,o){var i,r={type:t,color:n,negativeColor:o},a="pie"==t?60:150;for(i=0;i<e.length;i++)e[i]=e[i]||0;return webix.Sparklines.getTemplate(r)(e,{width:a,height:35})}function i(e,t){return t=t||e,'<a target="blank" href="'+e+'">'+t+"</a>"}function r(e,t,n){return e?t:n}t.__esModule=!0,t.IMAGE=n,t.SPARKLINE=o,t.LINK=i,t.IF=r},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e.attachEvent("onComponentInit",function(){return s(e)});var t=e.config.readonly,n={view:"toolbar",id:"bottom-toolbar",css:"webix_ssheet_bottom_toolbar webix_layout_toolbar",paddingY:0,height:34,elements:[{view:"button",type:"htmlbutton",width:34,id:"add-sheet",label:"<span class='webix_ssheet_icon_add_sheet'></span>",tooltip:webix.i18n.spreadsheet.tooltips["add-sheet"]||"",hidden:t},{id:"sheets",view:"sheets",xCount:5,editable:!t,editaction:"dblclick",editor:"text",editValue:"value",type:{width:e.config.sheetTabWidth,height:32,template:function(e){return"<div>"+e.value+"</div>"+(t?"":"<div class='webix_input_icon fa-angle-down webix_ssheet_sheet_arrow'></div>")}},on:{onItemClick:function(t){t!=e._activeSheet&&e.showSheet(t)}}},{id:"menu-pager",view:"pager",autosize:!0,template:function(){var e="<button type='button' webix_p_id='prev' class='webix_pager_item'><span class='webix_icon fa-caret-left'></span></button>";return e+="<button type='button' webix_p_id='next' class='webix_pager_item'><span class='webix_icon fa-caret-right'></span></button>"}}]};return e.callEvent("onViewInit",["bottom-toolbar",n]),n}function r(e){for(var t=[],n=0;n<R.length;n++)t.push({id:R[n],value:webix.i18n.spreadsheet.menus[R[n]]||R[n]});var o={view:"ssheet-suggest",data:t};return e.callEvent("onViewInit",["sheet-menu",o]),o}function a(e,t){var n=e.$$("sheets");if(n){n.clearAll();var o=[];t.sheets.forEach(function(e){o.push({id:e.name,value:e.name})}),n.parse(o)}}function s(e){e.$$("add-sheet")&&e.$$("add-sheet").attachEvent("onItemClick",function(){u(e)}),l(e),e.attachEvent("onAfterSheetShow",function(t){return f(e,t)}),e.attachEvent("onCommand",function(e){M[e.id]&&M[e.id](this)}),e.$$("sheets")&&(e.$$("sheets").data.attachEvent("onStoreUpdated",function(){
return d(e)}),e.$$("sheets").attachEvent("onAfterEditStop",function(t){return v(e,t.old,t.value)}),e.$$("sheets").on_click.webix_ssheet_sheet_arrow=function(t,n){e.$sheetMenu||(e.$sheetMenu=webix.ui(r(e)),e.$sheetMenu.attachEvent("onItemClick",function(t){return S(e,t)})),e.$sheetMenu.getItem("remove-sheet")&&(1==e.$$("sheets").count()?e.$sheetMenu.disableItem("remove-sheet"):e.$sheetMenu.enableItem("remove-sheet")),e.callEvent("onBeforeSheetMenu",[n])&&e.$sheetMenu.show(t)})}function l(e){e.$$("menu-pager")&&(e.$$("sheets").define("pager",e.$$("menu-pager")),e.$$("menu-pager").attachEvent("onAfterRender",function(){this.data.page?webix.html.removeCss(this.$view.firstChild,"ssheet_pager_inactive",!0):webix.html.addCss(this.$view.firstChild,"ssheet_pager_inactive",!0),this.data.page==this.config.limit-1?webix.html.addCss(this.$view.lastChild,"ssheet_pager_inactive",!0):webix.html.removeCss(this.$view.lastChild,"ssheet_pager_inactive",!0)}))}function u(e,t){var n,o,i;return n=V.findIndex(e._sheets,function(t){return t.name==e._activeSheet}),i=n>-1?n+1:e._sheets.length,o=c(e),t=t||{data:[]},e._sheets.splice(i,0,{name:o,content:t}),e.$$("sheets").add({id:o,value:o},i),e.showSheet(o),e.callEvent("onSheetAdd",[o]),o}function c(e){for(var t=e._sheets.length+1;_(e,webix.i18n.spreadsheet.labels.sheet+t);)t++;var n=webix.i18n.spreadsheet.labels.sheet+t;return n}function f(e,t){if(e.$$("sheets").select(t),e.$$("menu-pager")&&e.$$("sheets").config.xCount){var n=e.$$("sheets").getIndexById(t),o=Math.floor(n/e.$$("sheets").config.xCount);e.$$("menu-pager").select(o)}}function d(e){e.$$("menu-pager")&&(e.$$("sheets").count()<=e.$$("sheets").config.xCount?webix.html.addCss(e.$$("menu-pager").$view,"webix_sheet_hidden",!0):webix.html.removeCss(e.$$("menu-pager").$view,"webix_sheet_hidden"))}function h(e,t){e.$$("sheets").edit(t)}function p(e,t){var n,o;e._sheets.length>1&&(n=V.findIndex(e._sheets,function(e){return e.name==t}),e._sheets.splice(n,1),e._sheets[n]||(n=0),o=e._sheets[n],e._activeSheet=null,e.$$("sheets")&&(e.$$("sheets").remove(t),e.$$("sheets").refresh()),e.showSheet(o.name),e.callEvent("onSheetRemove",[t]))}function v(e,t,n){if(t!=n){for(var o=1;!n||_(e,n);)n=webix.i18n.spreadsheet.labels.sheet+o,o++;n=n.replace(/[\*\?\:\[\]\\\/]/g,"").substring(0,31);var i=_(e,t),r=e.$$("sheets");if(i.name=n,e._activeSheet==t&&(e._activeSheet=n),r){var a=r.getItem(t);a.value=n,r.data.changeId(t,n),r.refresh(n)}e.callEvent("onSheetRename",[t,n])}}function g(e,t){return _(e,e._activeSheet).content=t,e._sheets}function w(e,t){var n="";t=webix.isArray(t)?{sheets:t}:t,!t.excel&&t.sheets||!e._activeSheet?(t.sheets||(t=m(t)),n=t.sheets[0].name,e._activeSheet="",e._sheets=t.sheets,a(e,t),b(e,n)):(n=e._activeSheet,_(e,n).content=t,C(e,t))}function m(e){return{sheets:[{name:webix.i18n.spreadsheet.labels.sheet+1,content:e}]}}function b(e,t){if(t!=e._activeSheet&&e.callEvent("onBeforeSheetShow",[t])){e._activeSheet&&(_(e,e._activeSheet).content=e.serialize()),e._activeSheet=t;var n=_(e,t).content;C(e,n),e.callEvent("onAfterSheetShow",[t])}}function _(e,t){return V.find(e._sheets,function(e){return e.name==t})}function y(e,t){for(var n=0;n<e._sheets.length;n++)t(e._sheets[n].name)}function x(e){return e._activeSheet}function C(e,t){var n=(0,k.getDimension)(t.data,e.config.rowCount,e.config.columnCount),o=n[0],i=n[1];e.callEvent("onReset",[]),o==e.config.rowCount&&i==e.config.columnCount||(e.config.rowCount=o,e.config.columnCount=i,e._resetTable()),e.callEvent("onDataParse",[t]),e._table.refresh()}function $(e){u(e,e.serialize())}function S(e,t){e.$sheetMenu.data.getMark(t,"webix_disabled")||M[t](e)}t.__esModule=!0,t.init=i,t.reset=a,t.add=u,t.edit=h,t.remove=p,t.rename=v,t.serialize=g,t.load=w,t.newSheet=m,t.show=b,t.getSheet=_,t.eachSheet=y,t.getActive=x;var E=n(49),V=o(E),k=n(49),R=["rename-sheet","remove-sheet"],M={"remove-sheet":function(e){e.confirm({text:webix.i18n.spreadsheet.labels["sheet-remove-confirm"],callback:function(t){t&&p(e,e._activeSheet)}})},"rename-sheet":function(e){h(e,e._activeSheet)},"new-sheet":function(e){u(e)},"copy-sheet":function(e){$(e)}}},function(e,t){"use strict";function n(e,t){var n=o(e,t);return e[n]}function o(e,t){for(var n=-1,o=0;n<0&&o<e.length;o++)t(e[o])&&(n=o);return n}function i(e,t,n){for(var o=0;o<e.length;o++){var i=e[o];i[0]>t&&(t=i[0]),i[1]>n&&(n=i[1])}return[1*t,1*n]}t.__esModule=!0,t.find=n,t.findIndex=o,t.getDimension=i},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=0;t<C.length;t++)$[C[t].action]=new C[t].DialogBox(e);e.attachEvent("onCommand",function(e){var t=$[e.id];t&&t.open()})}t.__esModule=!0,t.init=i;var r=n(51),a=o(r),s=n(54),l=o(s),u=n(57),c=o(u),f=n(58),d=o(f),h=n(59),p=o(h),v=n(60),g=o(v),w=n(61),m=o(w),b=n(62),_=o(b),y=n(63),x=o(y),C=[a,l,c,d,p,g,m,_,x],$={}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=this;if(!this.config.upload){var n=new FileReader;return n.onload=function(e){return t.getFormView().elements.url.setValue(e.target.result)},n.readAsDataURL(e.file),!1}this.getFormView().elements.preview.setHTML("")}function s(e,t){this.getFormView().elements.url.setValue(t.imageURL)}function l(e){var t=e.cell,n=e.$dialog.getBody().elements.url.getValue();/^(https?:\/|data:image)\//i.test(n)||(n="http://"+n),e.view.addImage(t.row,t.column,n),e.close()}function u(e){e&&this.getFormView().elements.preview.setHTML("<img class='webix_ssheet_cimage' src='"+e+"'></img>")}t.__esModule=!0,t.DialogBox=t.action=void 0;var c=n(52),f=n(53);t.action="add-image",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){if(this.cell=this.view.getSelectedId(),!this.cell)return!1;t.elements.preview.setHTML(""),t.elements.url.setValue("");var n=this.view.getCellValue(this.cell.row,this.cell.column),o=(0,f.parseImage)(n);o&&o.url&&t.elements.url.setValue(o.url),t.elements.url.focus()},t.prototype.$init=function(){var e=this,t=this.view.config.save,n=t&&t.images||null;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["image-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"url",placeholder:webix.i18n.spreadsheet.labels["image-url"],on:{onChange:u}},{view:"label",label:webix.i18n.spreadsheet.labels["image-or"],align:"center"},{view:"uploader",label:webix.i18n.spreadsheet.labels["image-upload"],upload:n,on:{onBeforeFileAdd:a,onFileUpload:s}},{view:"formlate",name:"preview",borderless:!0,css:"webix_ssheet_preview",template:"",height:50}]},on:{onSaveClick:function(){return l(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(c.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.Dialog=void 0,n(19);t.Dialog=function(){function e(t){o(this,e),this.view=t}return e.prototype.$init=function(){},e.prototype.$show=function(){},e.prototype.$hide=function(){},e.prototype.open=function(){var e=this;this.$dialog||(this.$dialog=webix.ui(this.$init()),this.$dialog.attachEvent("onHide",function(){return e.$hide()}));var t=this.$dialog.getBody();this.$dialog.show(),this.$show(this.$dialog,t)===!1&&this.close()},e.prototype.close=function(){webix.UIManager.setFocus(this.view),this.$dialog.hide()},e}()},function(e,t){"use strict";function n(e){return'=IMAGE("'+e+'")'}function o(e){var t="=SPARKLINE("+e.range+',"'+e.type+'"';return"bar"===e.type?t+=',"'+e.color+'","'+e.negativeColor+'"':e.color&&(t+=',"'+e.color+'"'),t+")"}function i(e){if(e&&0===e.indexOf("=IMAGE("))return{url:a(e.substr(7,e.length-8))}}function r(e){if(e&&0===e.indexOf("=SPARKLINE(")){var t=e.substr(11,e.length-12).split(",");return{range:t[0],type:a(t[1]),color:a(t[2]),negativeColor:a(t[3])}}}function a(e){return e?(e=e.trim(),'"'===e[0]&&(e=e.substr(1)),'"'===e[e.length-1]&&(e=e.substr(0,e.length-1)),e):""}t.__esModule=!0,t.image=n,t.chart=o,t.parseImage=i,t.parseChart=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.$dialog.getBody(),n=t.getValues();if(n.range&&e.checkRange(n.range)){var o=void 0,i=(0,f.rangeValue)(e.view,n.range),r=s(t);for(o=0;o<i.length;o++)i[o]=i[o]||0;t.elements.preview.setValue(webix.Sparklines.getTemplate(r)(i,{width:200,height:40}))}}function s(e,t){var n=e.getValues();return t=t||{type:n.type},"bar"===n.type?(t.color=n.color_pos,t.negativeColor=n.color_neg):e.elements.color_def.isVisible()&&(t.color=n.color_def),t}function l(e){var t=e.$dialog.getBody(),n=s(t,t.getValues());e.checkRange(n.range)&&(e.view.addSparkline(e.cell.row,e.cell.column,n),e.close())}function u(e){var t=this.getFormView();switch(e){case"pie":t.showBatch(3);break;case"bar":t.showBatch(2);break;default:t.showBatch(1)}}t.__esModule=!0,t.DialogBox=t.action=void 0;var c=n(52),f=n(55),d=n(41),h=n(53),p=(t.action="add-sparkline",[{id:"line",value:"Line"},{id:"spline",value:"Spline"},{id:"splineArea",value:"Spline Area"},{id:"area",value:"Area"},{id:"bar",value:"Bar"},{id:"pie",value:"Pie"}]);t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){if(this.cell=this.view.getSelectedId(),!this.cell)return!1;var n=t.elements;this.view.$handleSelection=function(e,t,o,i){return n.range.setValue(o+":"+i),!1},n.range.setValue("");var o=this.view.getCellValue(this.cell.row,this.cell.column),i=(0,h.parseChart)(o);i&&(t.blockEvent(),n.type.setValue(i.type),n.range.setValue(i.range),i.color&&(n.color_def.setValue(i.color),n.color_pos.setValue(i.color)),i.negativeColor&&n.color_neg.setValue(i.negativeColor),t.unblockEvent(),a(this)),n.range.focus()},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["sparkline-title"],move:!0,position:"center",body:{view:"form",id:"form",visibleBatch:1,on:{onChange:function(){return a(e)}},elements:[{view:"richselect",name:"type",label:webix.i18n.spreadsheet.labels["sparkline-type"],value:"line",labelPosition:"left",suggest:{view:"ssheet-form-suggest",data:p},on:{onChange:u}},{view:"text",label:webix.i18n.spreadsheet.labels["sparkline-range"],name:"range"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-color"],name:"color_def",id:"add_sparkline_color",value:"#6666FF",batch:"1"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-positive"],name:"color_pos",value:"#6666FF",batch:"2"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-negative"],name:"color_neg",value:"#FF6666",batch:"2"},{view:"formlate",name:"preview",borderless:!0,css:"webix_ssheet_preview",height:50}]},on:{onSaveClick:function(){return l(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.checkRange=function(e){return!(!e||!(0,d.range)(e,this.view))||void this.view.alert({text:webix.i18n.spreadsheet.labels["error-range"]})},t}(c.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){var o=(0,r.range)(t,e),i=(0,a.getAccessor)(e,o[4]),s=i.getRange.apply(i,o);if(n){if(n.unique)for(var l={},u=s.length-1;u>=0;u--)l[s[u]]?s.splice(u,1):l[s[u]]=!0;n.order&&s.sort(),n.empty&&s.unshift({id:"$empty",$empty:!0,value:""})}return s}t.__esModule=!0,t.Ranges=void 0,t.rangeValue=i;var r=n(41),a=n(56);t.Ranges=function(){function e(t){o(this,e),this._master=t,this._ranges={}}return e.prototype.clear=function(){this._ranges={}},e.prototype.add=function(e,t){var n=!!this._ranges[e];this._ranges[e]=t,n&&this._master.callEvent("onMathRefresh",[])},e.prototype.getCode=function(e,t){return t?(0,a.getAccessor)(this._master,t).getRangeCode(e):this._ranges[e]},e.prototype.remove=function(e){delete this._ranges[e]},e.prototype.getRanges=function(){var e=[];for(var t in this._ranges)e.push({name:t,range:this._ranges[t]});return e},e.prototype.parse=function(e){if(e)for(var t=e.length;t--;){var n=e[t];this._ranges[n[0]]=n[1]}},e.prototype.serialize=function(){var e,t=[];for(e in this._ranges)t.push([e,this._ranges[e]]);return t},e}()},function(e,t,n){"use strict";function o(e,t,n){e.attachEvent("onBeforeSheetShow",function(){delete e._mathSheetCache[(0,l.getActive)(e)]}),e.attachEvent("onSheetRename",function(t){delete e._mathSheetCache[t]}),e.attachEvent("onSheetRemove",function(t){delete e._mathSheetCache[t]}),e._mathSheetCache={},e._mathSheetCore=t,e._mathSheetHelpers=n}function i(e,t){if(!t)return r(a(e));if(!e._mathSheetCache[t]){var n=e._mathSheetCache[t]=r(t===(0,l.getActive)(e)?a(e):s(e,t));n.init()}return e._mathSheetCache[t]}function r(e){return{init:function(){e.init()},getRangeCode:function(t){return e.getRangeCode(t)},getValue:function(t,n){var o=e.getCell(t,n),i=1*o;return isNaN(i)?o?o:"":i},getRangeValue:function(e){var t=this.getRangeCode(e)||e;if(t.indexOf(":")==-1)return[];var n=(0,u.range)(t);return this.getRange.apply(this,n)},getRange:function(t,n,o,i){for(var r=e.getRange(t,n,o,i),a=r.length-1;a>=0;a--){var s=r[a],l=1*s;r[a]=isNaN(l)?s?s:"":l}return r}}}function a(e){return{init:function(){},getRangeCode:function(t){return e.ranges.getCode(t)},getRow:function(t){return e.getRow(t)},getCell:function(t,n){return e.getRow(t)[n]},getRange:function(t,n,o,i){for(var r=[],a=t;a<=o;a++)for(var s=e.getRow(a),l=n;l<=i;l++)r.push(s[l]);return r}}}function s(e,t){var n=(0,l.getSheet)(e,t).content,o=[],i=[],r=[];return{init:function(){if(n.ranges)for(var a=0;a<n.ranges.length;a++){var s=n.ranges[a];r[s[0]]=s[1]}if(n.data)for(var l=0;l<n.data.length;l++){var u=n.data[l],c=u[0],f=u[1],d=u[2];if(o[c]||(o[c]=[]),o[c][f]=d,"="===d[0]){var h=e._mathSheetHelpers.parse(d,e._mathSheetCore,t);o[c][f]=h.handler;for(var p=0;p<h.triggers.length;p++)if(h.triggers[p][5]){i.push(n.data[l]);break}}}},getRangeCode:function(e){return r[e]},getRow:function(e){return o[e]||[]},getCell:function(t,n){var o=this.getRow(t)[n];return"function"==typeof o?e._mathSheetHelpers.execute(o,e._mathSheetCore):o},getRange:function(e,t,n,o){for(var i=[],r=e;r<=n;r++)for(var a=t;a<=o;a++)i.push(this.getCell(r,a));return i}}}t.__esModule=!0,t.init=o,t.getAccessor=i;var l=n(48),u=n(41)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var a=n(52),s=n(41);t.action="add-range",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e){var t=e.$$("table"),n=e.$$("form"),o="";n.clear(),n.elements.name.focus(),n.elements.range.setValue(this.view.getSelectedRange()),t.clearAll(),t.parse(this.view.ranges.getRanges()),this.view.$handleSelection=function(e,t,i,r){return n.elements.range.setValue((0,s.toSheetRange)(i,r,o)),!1}},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.saveClick=function(){var e=this.$dialog.$$("form"),t=e.getValues(),n=t.range.indexOf("!");if(t.range=t.range.substr(0,n+1)+t.range.substr(n+1).toUpperCase(),t.name=t.name.toUpperCase(),e.setValues(t),e.validate()){var o=this.$dialog.$$("table");t.id&&o.exists(t.id)?(this.view.ranges.remove(o.getItem(t.id).name),o.updateItem(t.id,t)):this.$dialog.$$("table").add(t),this.view.ranges.add(t.name,t.range),e.clear()}},t.prototype.removeRange=function(e){var t=this;this.view.confirm({text:webix.i18n.spreadsheet.labels["range-remove-confirm"],callback:function(n){if(n){var o=t.$dialog.$$("table");t.view.ranges.remove(o.getItem(e).name),o.remove(e)}}})},t.prototype.editRange=function(e){var t=this.$dialog.$$("form");t.setValues(this.$dialog.$$("table").getItem(e))},t.prototype.$init=function(){var e=this,t={type:"clean",cols:[{view:"ssheet-dialog-table",id:"table",borderless:!0,columns:[{id:"name",header:webix.i18n.spreadsheet.labels["range-name"],width:120},{id:"range",header:webix.i18n.spreadsheet.labels["range-cells"],width:140},{template:"<div class='webix_icon webix_ssheet_range_edit'></div>",width:30},{template:"<div class='webix_icon webix_ssheet_range_delete'></div>",width:30}],autowidth:!0,height:150,onClick:{webix_ssheet_range_delete:function(t,n){return e.removeRange(n)},webix_ssheet_range_edit:function(t,n){return e.editRange(n)}}},{width:250,view:"form",id:"form",rules:{name:function(t){var n=/^[A-Za-z]+$/.test(t),o=e.$dialog.$$("table"),i=e.$dialog.$$("form").getValues(),r=!0;return o.eachRow(function(e){var n=this.getItem(e);n.name==t&&n.id!=i.id&&(r=!1)}),n&&r},range:s.isRange},elementsConfig:{labelWidth:70},elements:[{view:"text",name:"name",gravity:1,label:webix.i18n.spreadsheet.labels["range-name"]},{view:"text",name:"range",gravity:1,label:webix.i18n.spreadsheet.labels["range-cells"]},{cols:[{},{view:"button",value:"Save",click:function(){return e.saveClick()}}]}]}]};return{view:"ssheet-dialog",move:!0,head:webix.i18n.spreadsheet.labels["range-title"],buttons:!1,autoheight:!0,width:610,position:"center",body:t,on:{onSaveClick:function(){return e.close()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(a.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var a=n(52),s=n(41),l=n(39);t.action="add-dropdown",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(){var e=this.$dialog.$$("form");if(this.cell=this.view.getSelectedId(!0),!this.cell.length)return!1;e.clear();var t=this.view.getCellEditor(this.cell[0].row,this.cell[0].column);t&&t.options&&e.elements.range.setValue(t.options),this.view.$handleSelection=function(t,n,o,i){return e.elements.range.setValue(o+":"+i),!1},e.elements.range.focus()},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",position:"center",head:webix.i18n.spreadsheet.labels["dropdown-title"],move:!0,body:{view:"form",id:"form",rows:[{view:"text",label:webix.i18n.spreadsheet.labels["dropdown-range"],name:"range"}]},on:{onSaveClick:function(){return e.okClick()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.okClick=function(){var e=this.$dialog.$$("form").elements.range.getValue();e?(0,s.range)(e,this.view)?(l.group.set(function(){for(var t=0;t<this.cell.length;t++)this.view.setCellEditor(this.cell[t].row,this.cell[t].column,{editor:"richselect",options:e})},this),this.close()):this.view.alert({text:webix.i18n.spreadsheet.labels["error-range"]}):this.close()},t}(a.Dialog)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(52),l=n(34),u=o(l);t.action="custom-format",t.DialogBox=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return a(t,e),t.prototype.$show=function(){var e=this.$dialog.$$("form");if(this.cell=this.view.getSelectedId(!0),!this.cell)return!1;if(e.clear(),e.elements.format.focus(),this.cell.length>0){var t=this.view.getStyle(this.cell[0].row,this.cell[0].column);t&&e.elements.format.setValue(u.getFormatSource(t.props.format))}},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",position:"center",head:webix.i18n.spreadsheet.labels["format-title"],move:!0,body:{view:"form",id:"form",rows:[{view:"text",label:webix.i18n.spreadsheet.labels["format-pattern"],name:"format",labelPosition:"top",placeholder:"[>100]0,000.00;[>0]None"}]},on:{onSaveClick:function(){return e.okClick()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.okClick=function(){for(var e=this.$dialog.$$("form").elements.format.getValue(),t=0;t<this.cell.length;t++)this.view.setFormat(this.cell[t].row,this.cell[t].column,e);this.view.refresh(),this.close()},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e.map(function(e){return e.id=e.css,e})}function s(){var e=this.getFormView();e.clear()}t.__esModule=!0,t.DialogBox=t.action=void 0;var l=n(52),u=(t.action="conditional-format",[{id:">",value:">"},{id:"<",value:"<"},{id:"=",value:"="},{id:"<>",value:"<>"}]);t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype._getCondition=function(){var e=this,t=this.view,n=this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews(),o=[];n.forEach(function(t){if(t.getValues){var n=t.getValues(),i=[];i.push(n.condition),"<>"!==n.condition?i.push(e._safeInt(n.value,10)):i.push([e._safeInt(n.value,10),e._safeInt(n.value2,10)]),i.push(n.style);for(var r=0;r<i.length;r++)if(""===i[r])return!1;o.push(i)}}),t.callEvent("onConditionSet",[o])},t.prototype._safeInt=function(e){var t=parseFloat(e);return t==e?t:e},t.prototype._setCondition=function(){var e=this.view,t=e.getSelectedId(!0),n=t[0];if(!t.length)return!1;var o=e.conditions.get(n.row,n.column);if(o){var i=this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();o.forEach(function(e,t){var n={};n.condition=e[0],webix.isArray(e[1])?(n.value=e[1][0].toString(),n.value2=e[1][1].toString()):n.value=e[1].toString(),n.style=e[2],i[t+1].setValues(n)})}},t.prototype.apply=function(){this._getCondition(),this.close()},t.prototype._clean=function(){var e=this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();e.forEach(function(e){e.setValues&&e.setValues({condition:"",value:"",value2:"",style:""})})},t.prototype.$show=function(){this.view.disable(),this._setCondition()},t.prototype.$hide=function(){this.view.enable(),this._clean()},t.prototype.getRows=function(e,t){for(var n={height:36,cols:[{view:"label",label:webix.i18n.spreadsheet.labels.display},{view:"label",label:webix.i18n.spreadsheet.labels.condition},{view:"label",label:webix.i18n.spreadsheet.labels.value},{width:25}]},o=[n],i={view:"form",padding:0,borderless:!0,elements:[{margin:10,cols:[{view:"richselect",name:"style",placeholder:webix.i18n.spreadsheet.labels["conditional-style"],css:"webix_ssheet_cformat_select",suggest:{padding:0,borderless:!0,css:"webix_ssheet_cformat_list",body:{template:function(e){var t="webix_ssheet_cformat "+e.css;return'<div class="'+t+'">'+e.name+"</div>"},data:e}}},{view:"richselect",width:100,name:"condition",placeholder:webix.i18n.spreadsheet.labels["conditional-operator"],on:{onChange:function(e){"<>"===e?this.getFormView().elements.value2.show():this.getFormView().elements.value2.hide()}},suggest:{view:"ssheet-form-suggest",body:{data:u}}},{cols:[{view:"text",placeholder:webix.i18n.spreadsheet.labels["conditional-number"],name:"value"},{view:"text",name:"value2",hidden:!0}]},{view:"icon",icon:"trash-o",width:25,click:s}]}]};t--;)o.push(i);return o},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["conditional-format"],position:"center",width:450,move:!0,buttons:!1,body:{view:"form",borderless:!0,rows:[{rows:this.getRows(a(this.view.config.conditionStyle),3)},{cols:[{gravity:2},{view:"button",value:webix.i18n.spreadsheet.labels.apply,click:function(){return e.apply()}}]}]},on:{onHideClick:function(){return e.close()}}}},t}(l.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.$dialog.getBody().getValues();webix.toExcel(e.view,t),e.close()}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(52);t.action="excel-export",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){this.view.disable(),t.elements.sheets.setValue(this.getSheets()),t.elements.filename.setValue("Data"),t.elements.filename.getInputNode().select()},t.prototype.$hide=function(){this.view.enable()},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["export-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"filename",placeholder:webix.i18n.spreadsheet.labels["export-name"]},{view:"multicheckbox",name:"sheets"}]},on:{onSaveClick:function(){return a(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.getSheets=function(){var e=this.view,t=e._sheets,n={};if(t&&t.length>1)for(var o=0;o<t.length;o++)n[t[o].name]=e._activeSheet===t[o].name?1:0;return n},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.view.getSelectedId(),n=e.$dialog.getBody().getValues(),o="";n.url&&(n.name=n.name||n.url,/^https?:\/\//i.test(n.url)||(n.url="http://"+n.url),o='=LINK("'+n.url+'","'+n.name+'")'),e.view.setCellValue(t.row,t.column,o),e.view.refresh(),e.close()}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(52);t.action="add-link",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){var n=this.view.getSelectedId();return!!n&&(this.restoreValue(t)||t.clear(),void t.elements.name.focus())},t.prototype.restoreValue=function(e){var t=this.view.getSelectedId();if(t){var n=this.view.getRow(t.row),o=n["$"+t.column]||n[t.column];if(o&&0===o.indexOf("=LINK")){var i=o.split('"');return e.setValues({name:i[3]||"",url:i[1]||""}),!0}}return!1},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["link-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"name",placeholder:webix.i18n.spreadsheet.labels["link-name"]},{view:"text",name:"url",placeholder:webix.i18n.spreadsheet.labels["link-url"]}]},on:{onSaveClick:function(){return a(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var a=n(52);t.action="print",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){t.setValues({data:"current",paper:"A4",fit:"page",mode:"landscape",sheetnames:1,margin:0})},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["print-title"],move:!0,modal:!0,width:520,height:520,position:"center",buttons:!1,body:{view:"form",elements:[{type:"section",template:webix.i18n.spreadsheet.labels["print-settings"]},{cols:[{view:"radio",name:"data",vertical:!0,options:[{id:"current",value:webix.i18n.spreadsheet.labels["current-sheet"]},{id:"all",value:webix.i18n.spreadsheet.labels["all-sheets"]},{id:"selection",value:webix.i18n.spreadsheet.labels.selection}],on:{onChange:function(e){if("all"==e){var t=this.getFormView();t.elements.sheetnames.setValue(1)}}}},{rows:[{view:"checkbox",name:"sheetnames",labelRight:webix.i18n.spreadsheet.labels["sheet-names"]},{view:"checkbox",
name:"borderless",labelRight:webix.i18n.spreadsheet.labels.borderless},{view:"checkbox",name:"skiprows",labelRight:webix.i18n.spreadsheet.labels["skip-rows"]},{view:"checkbox",name:"margin",labelRight:webix.i18n.spreadsheet.labels.margin}]}]},{type:"section",template:webix.i18n.spreadsheet.labels["print-paper"]},{view:"radio",name:"paper",options:[{id:"letter",value:webix.i18n.spreadsheet.labels["page-letter"]},{id:"A4",value:webix.i18n.spreadsheet.labels["page-a4"]},{id:"A3",value:webix.i18n.spreadsheet.labels["page-a3"]}]},{type:"section",template:webix.i18n.spreadsheet.labels["print-layout"]},{cols:[{view:"radio",name:"fit",options:[{id:"page",value:webix.i18n.spreadsheet.labels["page-width"]},{id:"data",value:webix.i18n.spreadsheet.labels["page-actual"]}]},{width:35},{view:"radio",width:220,name:"mode",options:[{id:"portrait",value:webix.i18n.spreadsheet.labels["page-portrait"]},{id:"landscape",value:webix.i18n.spreadsheet.labels["page-landscape"]}]}]},{cols:[{},{view:"button",type:"cancel",value:webix.i18n.spreadsheet.labels.cancel,autowidth:!0,click:function(){return e.close()}},{view:"button",value:webix.i18n.spreadsheet.labels.print,autowidth:!0,click:function(){return e.apply(e)}}]}]},on:{onHideClick:function(){return e.close()}}}},t.prototype.apply=function(e){var t=e.$dialog.getBody().getValues();t.margin=t.margin?0:{},this.close(),webix.print(e.view,t)},t}(a.Dialog)},function(e,t,n){"use strict";function o(e){e.attachEvent("onComponentInit",function(){return e.$$("context").attachTo(e._table.$view)});var t=webix.i18n.spreadsheet.menus,n={data:[{id:"clear-styles",value:t["clear-styles"]},{id:"lock-cell",value:t["lock-cell"]},{$template:"Separator"},{id:"sort",value:t.sort,submenu:[{id:"sort-asc",value:t["sort-asc"]},{id:"sort-desc",value:t["sort-desc"]}]},{id:"create-filter",value:t["create-filter"]},{$template:"Separator"},{id:"add-range",value:t["add-range"]},{id:"add-link",value:t["add-link"]}],column:[{id:"add",group:"column",value:t["insert-column"]},{id:"del",group:"column",value:t["delete-column"]},{id:"show",group:"column",value:t["show-column"]},{id:"hide",group:"column",value:t["hide-column"]}],row:[{id:"add",group:"row",value:t["insert-row"]},{id:"del",group:"row",value:t["delete-row"]},{id:"show",group:"row",value:t["show-row"]},{id:"hide",group:"row",value:t["hide-row"]}]},o={view:"contextmenu",id:"context",padding:0,submenuConfig:{padding:0},data:[],on:{onMenuItemClick:function(t){e.callEvent("onCommand",[this.getMenuItem(t)])},onBeforeShow:function(t){var o,a;if(a=e._table.locate(t),!a)return!1;if(o="",a.header&&"rowId"!==a.column?((0,r.isColSelected)(a.column,e)||(0,r.selectColumn)(a.column,e),o="column"):a.row&&("rowId"===a.column?((0,r.isRowSelected)(a.row,e)||(0,r.selectRow)(a.row,e),o="row"):((0,r.isCellSelected)(a.row,a.column,e)||e._table.addSelectArea(a,a),o="data")),o){var s=i(e,o,n[o]);if(s)return this.clearAll(),this.parse(s),webix.html.preventEvent(t),!0}return!1}}};e.callEvent("onViewInit",["context",o]),e.ui(o)}function i(e,t,n){var o={area:t,data:n};return e.callEvent("onContextMenuConfig",[o])?o&&o.data:null}t.__esModule=!0,t.init=o,t.getMenuData=i;var r=n(37)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=[a,d,T,l,_,k,M,B,c,x,$,A,p,E,g,m,z,N,j,L,G,Z],n=0;n<t.length;n++)t[n].init&&t[n].init(e)}t.__esModule=!0,t.operations=i;var r=n(66),a=o(r),s=n(70),l=o(s),u=n(37),c=o(u),f=n(71),d=o(f),h=n(72),p=o(h),v=n(74),g=o(v),w=n(75),m=o(w),b=n(34),_=o(b),y=n(76),x=o(y),C=n(40),$=o(C),S=n(77),E=o(S),V=n(78),k=o(V),R=n(79),M=o(R),I=n(81),A=o(I),O=n(82),z=o(O),U=n(38),T=o(U),P=n(39),B=o(P),F=n(86),N=o(F),D=n(85),j=o(D),H=n(87),L=o(H),K=n(88),G=o(K),W=n(89),Z=o(W)},function(e,t,n){(function(e){"use strict";function o(t){t.attachEvent("onCommand",function(n,o,i){if("add"==n.id||"del"==n.id){var r=t._table.getSelectArea();!r||o&&i||(o=r.start,i=r.end),o&&i&&d.group.set(function(){e(n,o,i,t)})}}),t.attachEvent("onUndo",function(e,n,o,i){"grid-change"==e&&r(t,i)})}function e(e,t,n,o,h,p){var v,g,w,m,b,_=0,y=0,x=o._table.getSelectArea(),C=o._table.getScrollState();w=o.serialize({math:!0}),m=webix.copy(w),b=a(e,t,n),o.$handleSelection=null,h||(0,d.ignoreUndo)(function(){o.callEvent("onAction",["before-grid-change",{name:b.name,inc:b.inc,data:w,start:t}])},o),v=w.data,"column"==e.group?(_=n.column-t.column+1,y=t.column,"add"==e.id?s(e,t,n,o,h,p,v):"del"==e.id&&(l(e,t,n,o,h,p,v),_=-_)):"row"==e.group&&(_=n.row-t.row+1,y=t.row,"add"==e.id?u(e,t,n,o,h,p,v):"del"==e.id&&(c(e,t,n,o,h,p,v),_=-_));var $={id:e.group,start:y,count:_};for(g=v.length;g--;)v[g][2]&&"string"==typeof v[g][2]&&"="==v[g][2].substr(0,1)&&(v[g][2]=(0,f.updateMath)(v[g][2],$));if(o.callEvent("onAction",["grid-change",{value:m,newValue:w}]),(0,d.ignoreUndo)(function(){r(o,w),o._table.scrollTo(C.x,C.y)},o),x){var S=o.$$("cells");x=i(x,S),x&&S.addSelectArea(x.start,x.end)}}function i(e,t){var n=t.count(),o=t.config.columns.length;return 1*e.start.row>n?null:1*e.end.row>n?null:1*e.start.column>o?null:1*e.end.column>o?null:e}function r(e,t){(0,d.ignoreReset)(function(){e.$handleSelection=null,e.parse(t)})}function a(e,t,n){var o=e.group,i="add"==e.id?1:"del"==e.id?-1:0;return i&&("row"==o&&(i+=i*(n.row-t.row)),"column"==o&&(i+=i*(n.column-t.column))),{name:o,inc:i}}function s(e,t,n,o,i,r,a){var s=a.length,l=n.column-t.column+1;for(o.config.columnCount+=l,o.reset();s--;)a[s][1]>=t.column&&(a[s][1]+=l);i?a.push.apply(a,r):o.callEvent("onColumnOperation",[e,t,n,null])}function l(e,t,n,o,i,r,a){var s=a.length,l=n.column-t.column+1;if(o.config.columnCount===l){if(t.column==n.column)return;n.column--,l--}o.config.columnCount-=l,o.reset();for(var u=[];s--;)a[s][1]>=t.column&&a[s][1]<=n.column?u.push(a.splice(s,1)[0]):a[s][1]>n.column&&(a[s][1]-=l);i||o.callEvent("onColumnOperation",[e,t,n,u])}function u(e,t,n,o,i,r,a){var s=a.length,l=n.row-t.row+1;for(o.config.rowCount+=l,o.reset();s--;)a[s][0]>=t.row&&(a[s][0]+=l);i?a.push.apply(a,r):o.callEvent("onRowOperation",[e,t,n,null])}function c(e,t,n,o,i,r,a){var s=a.length,l=n.row-t.row+1;if(o.config.rowCount===l){if(t.row==n.row)return;n.row--,l--}o.config.rowCount-=l,o.reset();for(var u=[];s--;)a[s][0]>=t.row&&a[s][0]<=n.row?u.push(a.splice(s,1)[0]):a[s][0]>n.row&&(a[s][0]-=l);i||o.callEvent("onRowOperation",[e,t,n,u])}t.__esModule=!0,t.init=o,t.process=e;var f=n(68),d=n(39)}).call(t,n(67))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function r(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){v&&h&&(v=!1,h.length?p=h.concat(p):g=-1,p.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=p.length;t;){for(h=p,p=[];++g<t;)h&&h[g].run();g=-1,t=p.length}h=null,v=!1,r(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,f,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var h,p=[],v=!1,g=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||v||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=u,d.addListener=u,d.once=u,d.off=u,d.removeListener=u,d.removeAllListeners=u,d.emit=u,d.prependListener=u,d.prependOnceListener=u,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){for(var n=(0,s.split)(e),o=n.length,i=1;i<o;i+=2){var r=n[i],l=r[0],u=r[1];"move"===t.id?(u+=t.column,l+=t.row):"row"===t.id&&t.start<=l?l+=t.count:"column"===t.id&&t.start<=u&&(u+=t.count),u&&l?n[i]=a.encode[u]+l:n[i]=0}return n.join("")}t.__esModule=!0,t.updateMath=i;var r=n(41),a=o(r),s=n(69)},function(e,t){"use strict";function n(e){var t=e.charCodeAt(0);return t>=65&&t<=122||36===t}function o(e){var t=e.charCodeAt(0);return t>=48&&t<=57}function i(e,t,i){for(var r=e.length,a=i,s=!1,l=t;l<r;l++){var u=e[l];if("'"!==u){if(!s)if("!"===u)a=e.substr(t,l-t),"'"===a[0]&&(a=a.substr(1,a.length-2)),t=l+1;else if(!n(u)&&!o(u))return[e.substr(t,l-t),l,t,a]}else s=!s}return[e.substr(t),l,t,a]}function r(e){return p.test(e)}function a(e){for(var t=0,n=0,o=1,i=!1,r=e.length-1;r>=0;r--){var a=e[r].charCodeAt(0);36!==a&&(a<58?(n+=(a-48)*o,o*=10):(i||(o=1,t=n,n=0,i=!0),n+=(a-64)*o,o*=26))}return[t,n]}function s(e,t,n){var o=a(t),i=o[0],r=o[1];return""!==n?(e.push([i,r,i,r,n]),'this.vs("'+n+'",'+i+","+r+")"):(e.push([i,r,i,r,""]),"this.v("+i+","+r+")")}function l(e){return"this.m."+e}function u(e,t,n,o){var i=t.ranges.getCode(n,o);if(!i)return"";var r=i.indexOf("!");r!==-1&&(o=i.substr(0,r),"'"===o[0]&&(o=o.substr(1,o.length-2)),i=i.substr(r+1));var a=i.split(":"),s=a[0],l=a[1];return f(e,s,l,o)}function c(e){return"this.p."+e}function f(e,t,n,o){var i=a(t),r=i[0],s=i[1],l=a(n),u=l[0],c=l[1];if(r>u){var f=r;r=u,u=f}if(s>c){var d=s;s=c,c=d}return""===o?(e.push([r,s,u,c,""]),"this.r("+r+","+s+","+u+","+c+")"):(e.push([r,s,u,c,o]),'this.rs("'+o+'",'+r+","+s+","+u+","+c+")")}function d(e){for(var t=[],o=0,s=!1,l=!1,u=1;u<e.length;u++){var c=e[u];if('"'==c)s=!s;else if(!s)if("{"==c&&"{"==e[u+1])l=!0;else if("}"==c&&"}"==e[u+1])l=!1;else if(!l&&("'"===c||n(c))){var f=i(e,u,""),d=f[0],h=f[1],p=f[3],v=h-1;if(""===p)"("!==e[v+1]&&r(d)&&(0!==u&&t.push(e.substr(o,u-o)),t.push(a(d)),o=v+1);else if(":"===e[v+1]){var g=i(e,v+2,""),w=g[1];v=w-1}u=v}}return o!=e.length&&t.push(e.substr(o)),t}function h(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a="return ",d=[],h=!1,p="",v="";if("="!==e[0])return!1;for(var g=1;g<e.length;g++){var w=e[g];if('"'==w)h=!h;else{if("{"==w&&"{"==e[g+1]){var m=i(e,g+2),b=m[0],_=m[1];g=_+1,a+=c(b);continue}if(!h&&("'"===w||n(w))){var y=i(e,g,o),x=y[0],C=y[1],$=y[2],S=y[3],E=x.toUpperCase();if(g=C-1,"("===e[g+1])a+=l(E);else if(r(E))":"===e[g+1]?(p=E,v=S,g++):""!==p?(a+=f(d,p,E,v),p=""):a+=s(d,E,S);else{var V=u(d,t,E,S);if(""==V)continue;a+=V}E!==x&&(e=e.substr(0,$)+E+e.substr(C));continue}}h?a+=w:"&"===w&&"&"!==e[g+1]?a+="+":"<"===w&&">"===e[g+1]?(a+="!=",g++):a+="="===w&&"<"!==e[g-1]&&">"!==e[g-1]?"==":w}return{code:a+";",triggers:d,text:e}}t.__esModule=!0,t.position=a,t.split=d,t.parse=h;var p=/^[A-Z\$]+[0-9]+$/},function(e,t,n){"use strict";function o(e,t){var n=67,o=88,r=e.$$("cells");r.attachEvent("onKeyPress",function(t,i){t!==n&&t!==o||!i.ctrlKey&&!i.metaKey||!r.getSelectedId()||(l=a(e,r),u=document.getElementsByClassName("webix_clipbuffer")[0].value,f=r.getSelectArea(),d=t===o)}),t||r.attachEvent("onPaste",function(t){i(e,r,t)})}function i(e,t,n){var o=t.getSelectArea();if(o){var i=o.start,a=n===u||""===u;""===u&&c&&c!==n&&(u=webix.undefined,a=!1),c=n;var s=a?l:webix.csv.parse(n,t.config.delimiter),p={id:"move",column:0,row:0};if(a?(p.column=i.column-f.start.column,p.row=i.row-f.start.row):d=!1,h.group.start(),1==s.length&&1==s[0].length?e.eachSelectedCell(function(t){var n={id:"move",column:p.column+1*t.column-i.column,row:p.row+1*t.row-i.row};r(e,t.row,t.column,s[0][0],a,n)}):t.mapCells(i.row,i.column,s.length,null,function(t,n,o,i,l){if(s[i]&&s[i].length>l){var u=s[i][l];r(e,n,o,u,a,p)}},!0),d){for(var v=f.start.row;v<=f.end.row;v++)for(var g=f.start.column;g<=f.end.column;g++)e.setCellValue(v,g,null),e.setStyle(v,g,null);d=!1}h.group.end(),e.refresh()}}function r(e,t,n,o,i,r){var a=o,l=null;"object"===("undefined"==typeof o?"undefined":s(o))&&(a=o.math?(0,p.updateMath)(o.math,r):o.text,l=o.style),e.setCellValue(t,n,a),i&&e.setStyle(t,n,l)}function a(e,t){var n,o,i=[];return t.mapSelection(function(r,a,s){a!=o&&(n=[],i.push(n),o=a);var l=t.getItem(a),u=l["$"+s];return n.push({text:r,math:u,style:e.getStyle(a,s)}),r}),i}t.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.init=o;var l,u,c,f,d,h=n(39),p=n(68)},function(e,t,n){"use strict";function o(e){e.conditions={_empty:!0,_pull:{},handlers:{">":function(e,t){return e>t},"<":function(e,t){return e<t},"=":function(e,t){return e==t},"<>":function(e,t){return webix.isArray(t)&&e<t[1]&&e>t[0]}},add:v,remove:g,update:h,get:p,parse:f,serialize:w,clear:d},e.attachEvent("onConditionSet",function(t){return r(e,t)}),e.attachEvent("onUndo",function(t,n,o,i){"condition"==t&&a(e,n,o,i)}),e.attachEvent("onDataSerialize",function(t){return s(e,t)}),e.attachEvent("onDataParse",function(t){return l(e,t)}),e.attachEvent("onColumnInit",function(t){return u(e,t)}),e.attachEvent("onReset",function(){return e.conditions.clear()}),e.attachEvent("onClearStyle",function(t,n){var o=e.conditions.get(t,n);o&&e.callEvent("onBeforeConditionSet",[t,n,o,null])&&(e.conditions.remove(t,n),e.refresh())}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&m(t.name,t.inc,t.data,t.start)}),i(e)}function i(e){e.conditions.clear()}function r(e,t){b.group.set(function(){e.eachSelectedCell(function(n){var o=e.conditions.get(n.row,n.column);e.callEvent("onBeforeConditionSet",[n.row,n.column,o||null,t,b.group.value])&&e.conditions.update(n.row,n.column,t)})}),e.refresh()}function a(e,t,n,o){e.conditions.get(t,n)&&e.conditions.remove(t,n),o&&e.conditions.update(t,n,o)}function s(e,t){t.conditions=e.conditions.serialize()}function l(e,t){e.conditions.parse(t.conditions)}function u(e,t){t.cssFormat=function(t,n,o,i){if(e.conditions._empty)return"";var r,a;if(r=e.conditions.get(o,i),!r)return"";for(a=r.length;a--;){var s=e.conditions.handlers[r[a][0]];if(s&&s(n[i],r[a][1]))return r[a][2]}return""}}function c(e,t,n,o){return o._empty=!1,e[t]||(e[t]={}),e[t][n]||(e[t][n]=[]),e[t][n]}function f(e){if(this._empty=!0,e)for(var t=e.length;t--;){var n=e[t],o=c(this._pull,n[0],n[1],this);o.push([n[2],n[3],n[4]])}}function d(){this._pull={}}function h(e,t,n){var o=this.get(e,t);o||c(this._pull,e,t,this),this._pull[e][t]=n}function p(e,t){return e?t?this._pull[e]?this._pull[e][t]:null:this._pull[e]:this._pull}function v(e,t,n,o,i){var r=c(this._pull,e,t,this);r.push([n,o,i])}function g(e,t){var n=this.get(e,t);n&&delete this._pull[e][t]}function w(){var e,t,n,o,i=[];for(o in this._pull)for(e in this._pull[o])for(n=0;n<this._pull[o][e].length;n++)t=this._pull[o][e][n],i.push([o,e,t[0],t[1],t[2]]);return i}function m(e,t,n,o){var i=n.conditions,r=i.length;if(t)for(;r--;){var a=i[r],s=a[0],l=a[1];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&("row"==e?s<o.row-t?i.splice(r,1):i[r][0]=1*s+t:"column"==e&&(l<o.column-t?i.splice(r,1):i[r][1]=1*l+t))}}t.__esModule=!0,t.init=o;var b=n(39)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){function t(t,o,i){var r=e.getRow(t);r[o]=f(i,c),n(t,o)}function n(e,n){var o=a[e];if(o){var i=o[n];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(g++,g>100)return;t(s.row,s.column,s.handler),g--}}}function o(){var t=e.$$("cells"),n=t.getState(),o=n.ids.concat(n.hidden);t.eachRow(function(e){for(var t=this.getItem(e),n=1;n<o.length;n++){var r=o[n],a=t["$"+r];a&&i(e,r,a)}},!0),t.refresh()}function i(t,o,i){var d=u[t];if(d&&d[o]&&s(a,u,o,t),i&&0===i.toString().indexOf("=")){var h=l(i,c,""),p=e.getRow(t);p[o]=f(h.handler,c),p["$"+o]=h.text,h.triggers.length&&r(a,u,h.triggers,{row:t,column:o,handler:h.handler},e.getActiveSheet())}g=0,n(t,o)}var a=[],u=[],c=d(e);e.ranges=c.ranges=new m.Ranges(e),c.p=_.init(e),e.attachEvent("onReset",function(){a=[],u=[],e.ranges.clear()}),e.attachEvent("onCellChange",i),e.attachEvent("onMathRefresh",o),e.attachEvent("onDataSerialize",function(t){return h(e,t)}),e.attachEvent("onDataParse",function(t){return p(e,t)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&v(t.name,t.inc,t.data,t.start)});var g;S.init(e,c,{parse:l,execute:f})}function r(e,t,n,o,i){for(var r=[],s=0;s<n.length;s++){var l=n[s];if(""===l[4]||l[4]===i)for(var u=l[0];u<=l[2];u++){var c=e[u];c||(c=e[u]=[]);for(var f=l[1];f<=l[3];f++){var d=c[f];d||(d=c[f]=[]),r.push([u,f]),d.push(o)}}}a(t,o.row,o.column,r)}function a(e,t,n,o){var i=e[t];i||(i=e[t]=[]),i[n]=o}function s(e,t,n,o){var i=t[o][n];t[o][n]=null;for(var r=i.length-1;r>=0;r--)for(var a=i[r],s=e[a[0]][a[1]],l=s.length-1;l>=0;l--){var u=s[l];u.row==o&&u.column==n&&s.splice(l,1)}}function l(e,t,n){var o=x.parse(e,t,n);return o.handler=c(o.code),o}function u(){return"ERROR"}function c(e){try{return new Function(e)}catch(t){return u}}function f(e,t){var n;try{n=e.call(t)}catch(o){return"ERROR"}return"number"==typeof n?Math.round(1e5*n)/1e5:"string"!=typeof n?n?n.toString():"ERROR":n}function d(e){var t=S.getAccessor(e);return{rs:function(t,n,o,i,r){return S.getAccessor(e,t).getRange(n,o,i,r)},r:t.getRange,vs:function(t,n,o){return S.getAccessor(e,t).getValue(n,o)},v:t.getValue,m:g.methods,p:{}}}function h(e,t){t.ranges=e.ranges.serialize()}function p(e,t){e.ranges.parse(t.ranges)}function v(e,t,n,o){for(var i=n.ranges,r=0;r<i.length;r++)i[r][1]=(0,C.changeRange)(i[r][1],e,t,o)}t.__esModule=!0,t.init=i;var g=n(44),w=n(55),m=o(w),b=n(73),_=o(b),y=n(69),x=o(y),C=n(41),$=n(56),S=o($)},function(e,t){"use strict";function n(e){var t={};return e.setPlaceholder=function(n,i){if("object"===("undefined"==typeof n?"undefined":o(n)))for(var r in n)t[r.toLowerCase()]=n[r];else t[n.toString().toLowerCase()]=i;e.callEvent("onMathRefresh",[])},t}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.init=n},function(e,t){"use strict";function n(e){e.attachEvent("onDataParse",function(t){return i(e,t)}),e.attachEvent("onDataSerialize",function(t,n){return o(e,t,n)}),e.attachEvent("onUndo",function(t,n,o,i){"value"==t&&r(e,n,o,i)})}function o(e,t,n){var o=!n||n.math!==!1,i=[],r=e.$$("cells"),a=r.getState(),s=a.ids.concat(a.hidden),l=s.indexOf("rowId");l>-1&&s.splice(l,1),r.eachRow(function(e){for(var t=this.getItem(e),n=0;n<s.length;n++){var r=s[n],a=t[r],l=t.$cellCss?t.$cellCss[r]||"":"";o&&(a=t["$"+r]||a);var u=a||0===a;(u||l)&&i.push([1*e,1*r,u?a:"",l])}},!0),t.table={frozenColumns:r.config.leftSplit-1,frozenRows:r.config.topSplit},t.data=i}function i(e,t){var n=e.$$("cells"),o=t.table||{frozenColumns:0,frozenRows:0};o&&(webix.isUndefined(o.frozenColumns)||o.frozenColumns+1==n.config.leftSplit||e.freezeColumns(o.frozenColumns),webix.isUndefined(o.frozenRows)||o.frozenRows==n.config.topSplit||e.freezeRows(o.frozenRows)),t.sizes&&n.define("fixedRowHeight",!1);for(var i=0;i<t.data.length;i++){var r=t.data[i],a=r[0],s=r[1],l=r[2],u=r[3],c=n.getItem(a);c[s]=l,u&&(c.$cellCss=c.$cellCss||{},c.$cellCss[s]=u),e.callEvent("onCellChange",[a,s,l])}}function r(e,t,n,o){e.setCellValue(t,n,o)}t.__esModule=!0,t.init=n},function(e,t,n){"use strict";function o(e){var t=e._table;e.attachEvent("onReset",function(){return i(e)}),i(e),t.attachEvent("onBeforeEditStart",function(t){var n=this.getColumnConfig(t.column);if(this._ssEditors[t.row]){var o=this._ssEditors[t.row][t.column];o&&(webix.extend(n,o,!0),o.options&&"string"==typeof o.options&&(n.options=(0,f.rangeValue)(e,o.options,{unique:!0,empty:!0,order:!0})))}}),t.attachEvent("onAfterEditStop",function(t,n){if(this.getColumnConfig(n.column).editor="text",l(e,n.row,n.column))return e.filterSpreadSheet()}),t.on_click.ss_filter=function(e,t){this.edit(t)},e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&c(t.name,t.inc,t.data,t.start)})}function i(e){e._table._ssEditors={},e._table._ssFilters={}}function r(e,t){var n,o,i=e._table._ssEditors,r=[];for(n in i)for(o in i[n])l(e,n,o)||r.push([n,o,i[n][o]]);t.editors=r}function a(e,t){var n,o=t.editors;if(o)for(n=0;n<o.length;n++)e.setCellEditor.apply(e,o[n])}function s(e,t){var n=!1;e._table.editStop(),(0,d.eachRange)(t,e,function(e,t){var o=e._table._ssEditors[t.row],i=e._table._ssFilters[t.row];o&&o[t.column]&&(delete o[t.column],e._table.removeCellCss(t.row,t.column,"ss_filter")),i&&i[t.column]&&(delete i[t.column],n=!0)}),n&&e.filterSpreadSheet()}function l(e,t,n){var o=e._table._ssFilters;return o[t]&&o[t][n]}function u(e,t,n){var o=e._table._ssFilters,i=o[t]=o[t]||{};i[n]=[t,n],e.callEvent("onAction",["addFilter",{row:t,column:n}]),e.setCellValue(t,n,"")}function c(e,t,n,o){var i=void 0,r=n.editors;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1],u=a[2];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(u=r[i][2]=webix.copy(u),"row"==e?s<o.row-t?r.splice(i,1):r[i][0]=1*s+t:"column"==e&&(l<o.column-t?r.splice(i,1):r[i][1]=1*l+t)),u.options=(0,d.changeRange)(u.options,e,t,o)}}t.__esModule=!0,t.init=o,t.serialize=r,t.load=a,t.clearEditors=s,t.addCellFilter=u;var f=n(55),d=n(41)},function(e,t,n){(function(e){"use strict";function n(t){t.attachEvent("onCommand",function(n){if("show"==n.id||"hide"==n.id){var o=t._table.getSelectArea();o&&e(n,o.start,o.end,t)}}),o(t),t.attachEvent("onUndo",function(n,o,i,r,a){if(!("hide"!=n.id&&"show"!=n.id||"column"!=n.group&&"row"!=n.group)){var s=n.id;a||(s="hide"==s?"show":"hide");var l=o||i;e({id:s,group:n.group},l.start,l.end,t,!0)}}),t.attachEvent("onHardReset",function(){return o(t)}),t.attachEvent("onAction",function(e,n){"before-grid-change"==e&&v(t,n.name,n.inc,n.data,n.start)})}function o(e,t){t?e["_hidden_"+t+"_hash"]={}:(e._hidden_cols_hash={},e._hidden_rows_hash={})}function i(e){return webix.isArray(e)?e:[e,e]}function r(e,t,n){if(t){var o=i(t);if(e._hidden_cols_hash[o[0]]||!webix.isUndefined(n)&&!n){if(e._hidden_cols_hash[o[0]]&&(webix.isUndefined(n)||!n)){var r=o[0]>1?1:-1;f({id:"show",group:"column"},{column:o[0]+r},{column:o[1]+r},e)}}else h({id:"hide",group:"column"},{column:o[0]},{column:o[1]},e)}else{var a=e.getSelectedId(!0),s={id:n===!1?"show":"hide",group:"column"};a.length&&e.callEvent("onCommand",[s,a[0],a[a.length-1]])}}function a(e,t){return!e._hidden_cols_hash[t]}function s(e,t,n){if(t){var o=i(t);if(e._hidden_rows_hash[o[0]]||!webix.isUndefined(n)&&!n){if(e._hidden_rows_hash[o[0]]&&(webix.isUndefined(n)||!n)){var r=o[0]>1?1:-1;d({id:"show",group:"row"},{row:o[0]+r},{row:o[1]+r},e)}}else p({id:"hide",group:"row"},{row:o[0]},{row:o[1]},e)}else{var a=e.getSelectedId(!0),s={id:n===!1?"show":"hide",group:"row"};a.length&&e.callEvent("onCommand",[s,a[0],a[a.length-1]])}}function l(e,t){return!e._hidden_rows_hash[t]}function u(e,t){var n=[],o=[];for(var i in e._hidden_rows_hash)n.push(i);for(var r in e._hidden_cols_hash)o.push(r);(n.length||o.length)&&(t.table.hidden={}),n.length&&(t.table.hidden.row=n),o.length&&(t.table.hidden.column=o)}function c(e,t){if(o(e),!webix.isUndefined(t.table)&&!webix.isUndefined(t.table.hidden)){var n=t.table.hidden;if(n.row&&n.row.length)for(var i=0;i<n.row.length;i++)p({id:"hide",group:"row"},{row:n.row[i]},{row:n.row[i]},e,!0);if(n.column&&n.column.length)for(var r=0;r<n.column.length;r++)h({id:"hide",group:"column"},{column:n.column[r]},{column:n.column[r]},e,!0)}}function e(e){"column"==e.group?"show"==e.id?f.apply(this,arguments):"hide"==e.id&&h.apply(this,arguments):"row"==e.group&&("show"==e.id?d.apply(this,arguments):"hide"==e.id&&p.apply(this,arguments))}function f(e,t,n,o,i){for(var r=n.column;r>=t.column;){var a=r;if(i||(a=o._hidden_cols_hash[1*r-1]||o._hidden_cols_hash[1*r+1]||!1),a!==!1){delete o._hidden_cols_hash[a];var s=o.$$("cells").getColumnConfig(a-1||"rowId").header[0];s.css=s.css.replace("webix_ssheet_hide_column",""),o.$$("cells").showColumn(a),t.column=t.column<a?t.column:a,n.column=n.column>a?n.column:a,i||o.callEvent("onColumnOperation",[e,{column:a},{column:a},null])}r--}}function d(e,t,n,o,i){for(var r=n.row;r>=t.row;){var a=r;if(i||(a=o._hidden_rows_hash[1*r-1]||o._hidden_rows_hash[1*r+1]||!1),a!==!1){if(delete o._hidden_rows_hash[a],a-1===0){var s=o.$$("cells").getColumnConfig("rowId").header[0];s.css=s.css.replace("webix_ssheet_hide_row",""),o.$$("cells").refreshColumns()}else o.$$("cells").removeCellCss(a-1,"rowId","webix_ssheet_hide_row");i||o.callEvent("onRowOperation",[e,{row:a},{row:a},null])}r--}o.$$("cells").filter(function(e){return!o._hidden_rows_hash[e.id]})}function h(e,t,n,o,i){var r=n.column;if(o.$handleSelection=null,o.$$("cells").unselect(),n.column<1||t.column<1)return void delete o._hidden_cols_hash[t.column];for(;r>=t.column;){o._hidden_cols_hash[r]=r;var a=o.$$("cells").getColumnConfig(r-1||"rowId").header[0];a.css=(a.css||"")+" webix_ssheet_hide_column",o.$$("cells").hideColumn(r),r--}i||o.callEvent("onColumnOperation",[e,t,n,null])}function p(e,t,n,o,i){var r=n.row;if(n.row<1||t.row<1)return void delete o._hidden_rows_hash[t.row];for(;r>=t.row;){if(o._hidden_rows_hash[r]=r,r-1===0){var a=o.$$("cells").getColumnConfig("rowId").header[0];a.css=(a.css||"")+" webix_ssheet_hide_row",o.$$("cells").refreshColumns()}else o.$$("cells").addCellCss(r-1,"rowId","webix_ssheet_hide_row");r--}o.$$("cells").filter(function(e){return!o._hidden_rows_hash[e.id]}),i||o.callEvent("onRowOperation",[e,t,n,null])}function v(e,t,n,i,r){if(i.table&&i.table.hidden&&i.table.hidden[t]&&i.table.hidden[t].length){"column"===t&&o(e,"cols"),"row"===t&&o(e,"rows");var a=r[t],s=a+n;if(a>s){var l=[s,a];a=l[0],s=l[1]}for(var u=a;u<s;u++)for(var c=0;c<i.table.hidden[t].length;c++)i.table.hidden[t][c]>=u&&(i.table.hidden[t][c]=1*i.table.hidden[t][c]+(n>0?1:-1))}}t.__esModule=!0,t.init=n,t.reset=o,t.setColumnState=r,t.isColumnVisible=a,t.setRowState=s,t.isRowVisible=l,t.serialize=u,t.load=c}).call(t,n(67))},function(e,t,n){"use strict";function o(e){if(e.config.resizeCell){var t=e.$$("cells");t.define("resizeRow",{headerOnly:!0,size:10}),t.define("resizeColumn",{headerOnly:!0,size:10}),t.define("fixedRowHeight",!1),t.attachEvent("onRowResize",function(t){e.$$("cells").refreshSelectArea(),e._save("sizes",{row:t,column:0,size:e.getRow(t).$height})}),t.attachEvent("onColumnResize",function(t){e.$$("cells").refreshSelectArea(),e._save("sizes",{row:0,column:t,size:e.getColumn(t).width})}),e.attachEvent("onUndo",function(t,n,o,r){"c-resize"!=t&&"r-resize"!=t||i(e,n,o,r)})}e.attachEvent("onDataParse",function(t){if(t.sizes){for(var n=0;n<t.sizes.length;n++){var o=t.sizes[n];if(1*o[0]!==0){var i=e.getRow(o[0]);i&&(i.$height=1*o[2])}else{var r=e.getColumn(o[1]);r&&(r.width=1*o[2])}}t.sizes.length&&e.refresh(!0)}}),e.attachEvent("onDataSerialize",function(t){for(var n=[],o=e.$$("cells"),i=o.getState().order,r=o.data.order,a=o.config.columnWidth,s=o.config.rowHeight,l=1;l<i.length;l++){var u=o.getColumnConfig(i[l]).width;u&&u!=a&&n.push([0,l,u])}for(var c=0;c<r.length;c++){var f=o.getItem(r[c]).$height;f&&f!=s&&n.push([1*r[c],0,f])}t.sizes=n}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&r(t.name,t.inc,t.data,t.start)}),e.attachEvent("onBeforeStyleChange",function(t,n,o,i){i&&"wrap"===i.props.wrap&&o.props.wrap!=i.props.wrap&&delete e._table.getItem(t).$height}),e.attachEvent("onStyleChange",a),e.attachEvent("onCellChange",a)}function i(e,t,n,o){t?(e.$$("cells").getItem(t).$height=o,e._save("sizes",{row:t,column:0,size:o})):e._table.setColumnWidth(n,o),e._table.refreshSelectArea()}function r(e,t,n,o){var i=void 0,r=n.sizes,a=[];if(t){for(i=r.length-1;i>=0;i--){var s=r[i],l=s[0],u=s[1],c=s[2];l&&"row"==e&&l>=o.row||u&&"column"==e&&u>=o.column?(l="row"==e?1*l+t:l,u="column"==e?1*u+t:u,("row"==e&&l>0||"column"==e&&u>0)&&a.push([l,u,c])):a.push(r[i])}n.sizes=a}}function a(e,t){var n=this,o=(0,s.getStyle)(n,{row:e,column:t});if(o&&o.props.wrap){var i=n._table.getItem(e),r=i.$height||n._table.config.rowHeight;n._table.eachColumn(function(t,o){var i=(0,s.getStyle)(n,{row:e,column:t});if(i&&i.props&&"wrap"===i.props.wrap){var a=this.getText(e,t);r=Math.max(r,(0,s.getTextSize)(n,a,i.id,o.width).height)}}),i.$height=r}}t.__esModule=!0,t.init=o;var s=n(38)},function(e,t,n){"use strict";function o(e){var t=e._table,n=0;t.attachEvent("onAreaDrag",function(){return n=new Date}),t.attachEvent("onBeforeAreaRemove",function(){if(e.$handleSelection&&new Date-n<500)return!1}),t.attachEvent("onBeforeAreaAdd",function(n){if("rowId"==n.start.column)return!1;var o=t.getEditor();if(!o||o.row==n.start.row&&o.column==n.start.column&&o.row==n.start.row&&o.column==n.start.column||t.editCancel(),!e.$handleSelection)return!0;var r=i.encode[n.start.column]+n.start.row,a=i.encode[n.end.column]+n.end.row,s=e.$handleSelection(n.start,n.end,r,a);return s!==!1&&(e.$handleSelection=null,t.removeSelectArea()),s}),webix.event(t.$view,"mousedown",function(t){if(e.$handleSelection)return webix.html.preventEvent(t)})}t.__esModule=!0,t.init=o;var i=n(41)},function(e,t,n){"use strict";function o(e){e.attachEvent("onCommand",function(t){"sort-asc"!==t.id&&"sort-desc"!==t.id||i(e,null,t.id.replace("sort-",""))})}function i(e,t,n,o){if(t=t||e._table.getSelectArea()){t=(0,l.rangeObj)(t,e);var i=t;t.start.row===t.end.row&&(i=(0,a.expandSelection)(t,e));var s=e.getCellValue(t.start.row,t.start.column);o=o||(isNaN(parseFloat(s))?"str":"int"),n=n&&"asc"!==n?-1:1,u.group.set(function(){return r(i,t.start.column,o,n,e)})}}function r(e,t,n,o,i){for(var r=e.start.column;r<=e.end.column;r++){for(var a=[],l=e.start.row;l<=e.end.row;l++){var u=i.getRow(l),f=u[r],d=i.getStyle(l,r),h=u["$"+r];a.push({value:f,style:d,math:h,row:l})}a.sort(c[n](o,"value"));for(var p=e.start.row;p<=e.end.row;p++){var v=a.shift();if(i.setStyle(p,r,v.style||null),v.math){var g={id:"move",row:p-v.row,column:0},w=(0,s.updateMath)(v.math,g);i.setCellValue(p,r,w)}else i.setCellValue(p,r,v.value)}}i.refresh()}t.__esModule=!0,t.init=o,t.sortRange=i;var a=n(80),s=n(68),l=n(41),u=n(39),c={"int":function(e,t){return function(n,o){var i=parseFloat(n[t])||-(1/0),r=parseFloat(o[t])||-(1/0);return(i>r?1:i==r?0:-1)*e}},str:function(e,t){return function(n,o){var i=(n[t]||"").toString().toLowerCase(),r=(o[t]||"").toString().toLowerCase();return(i>r?1:i==r?0:-1)*e}}}},function(e,t){"use strict";function n(e,t){for(var n=t.config.rowCount,i=t.config.columnCount,r=t._table,a=e.start.row,s=e.end.row,l=e.start.column,u=e.end.column,c=a-1;c>0&&o(c,e.start.column,r);c--)a=c;for(var f=s+1;f<n&&o(f,e.end.column,r);f++)s=f;for(var d=l-1;d>0&&o(e.start.row,d,r);d--)l=d;for(var h=u+1;h<i&&o(e.end.row,h,r);h++)u=h;var p={start:{row:a,column:l},end:{row:s,column:u}};return a==e.start.row&&s==e.end.row&&l==e.start.column&&u==e.end.column||t._table.addSelectArea(p.start,p.end),p}function o(e,t,n){var o=n.getItem(e)[t];return void 0!==o&&""!==o}t.__esModule=!0,t.expandSelection=n},function(e,t,n){"use strict";function o(e){e.attachEvent("onStyleChange",function(t,n,o){var r=i(e,t,n);r&&(r[3]=o?o.id:"")}),e.attachEvent("onDataParse",function(t){if(t.spans)for(var n=0;n<t.spans.length;n++){var o=t.spans[n];r(e,{row:o[0],column:o[1]},1*o[2],1*o[3])}}),e.attachEvent("onDataSerialize",function(t){var n=[],o=e.$$("cells").getSpan();if(o){for(var i in o){var r=o[i];for(var a in r){var s=r[a];n.push([1*i,1*a,s[0],s[1]])}}t.spans=n}}),e.attachEvent("onUndo",function(t,n,o,i,r){"span"!=t&&"split"!=t||("span"==t&&(r=!r),l(e,n,o,i,r))}),e.attachEvent("onAction",function(t,n){if("lock"==t)u(e,n.row,n.column,n.newValue);else if("before-grid-change"==t)c(n.name,n.inc,n.data,n.start);else if("check-borders"==t)return f(e,n.row,n.column,n.area,n.mode);
})}function i(e,t,n){var o=e.$$("cells").getSpan()[t];if(o)return o[n]}function r(e,t,n,o){if(!(n<2&&o<2)){var i=e.getRow(t.row),r=i.$cellCss?i.$cellCss[t.column]||"":"";d(e,t,n,o),e.$$("cells").addSpan(t.row,t.column,n,o,null,r),e._save("spans",{row:t.row,column:t.column,x:n,y:o})}}function a(e,t){e.$$("cells").removeSpan(t.row,t.column),e._save("spans",{row:t.row,column:t.column,x:0,y:0})}function s(e){var t,n,o,i;o=i=0,t=n=1/0;for(var r=0;r<e.length;r++){var a=1*e[r].column,s=1*e[r].row;t=Math.min(a,t),o=Math.max(a,o),n=Math.min(s,n),i=Math.max(s,i)}return{cell:{row:n,column:t},x:o-t+1,y:i-n+1}}function l(e,t,n,o,i){i?a(e,{row:t,column:n}):r(e,{row:t,column:n},o[0],o[1])}function u(e,t,n,o){var r=i(e,t,n);r&&(o?r[3].indexOf(h.lockCss)==-1&&(r[3]+=" "+h.lockCss):r[3]=r[3].replace(" "+h.lockCss,""),e._table.refresh())}function c(e,t,n,o){var i=void 0,r=n.spans;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l)}}function f(e,t,n,o,r){var a=i(e,t,n);return!(!a||!p[r])&&p[r](t,n,a,o)}function d(e,t,n,o){var i,r,a,s=1*t.row,l=1*t.column,u=!e.getCellValue(s,l);for(i=s;i<s+o;i++)for(r=l;r<l+n;r++)a=e.getCellValue(i,r),""===a||r==l&&i==s||(u&&(u=!1,e.setCellValue(s,l,a)),e.setCellValue(i,r,""))}t.__esModule=!0,t.init=o,t.addSpan=r,t.removeSpan=a,t.getRange=s;var h=n(40),p={"border-right":function(e,t,n,o){return o.end.column==t+n[0]-1},"border-bottom":function(e,t,n,o){return o.end.row==e+n[1]-1}}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){var t=[a,l,c,d,p,g,m];e.attachEvent("onDataSerialize",function(n){for(var o=0;o<t.length;o++)t[o].serialize&&t[o].serialize(e,n)}),e.attachEvent("onDataParse",function(n){for(var o=0;o<t.length;o++)t[o].load&&t[o].load(e,n)})}t.__esModule=!0,t.init=i;var r=n(83),a=o(r),s=n(84),l=o(s),u=n(40),c=o(u),f=n(75),d=o(f),h=n(85),p=o(h),v=n(34),g=o(v),w=n(76),m=o(w)},function(e,t){"use strict";function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.$$("cells"),o=n.$view.className.indexOf("webix_borderless")!=-1;"toggle"===t&&(t=!o),!o&&t?webix.html.addCss(n.$view,"webix_borderless",!0):o&&!t&&webix.html.removeCss(n.$view,"webix_borderless")}function o(e,t){t.table.gridlines=e.$$("cells").$view.className.indexOf("webix_borderless")!=-1?0:1}function i(e,t){var o=!1;webix.isUndefined(t.table)||webix.isUndefined(t.table.gridlines)||(o=!t.table.gridlines),n(e,o)}t.__esModule=!0,t.hideGridlines=n,t.serialize=o,t.load=i},function(e,t){"use strict";function n(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.$$("cells");"toggle"===t&&(t=n.config.header),n.config.header&&t?(n.config.header=!1,n.isColumnVisible("rowId")&&n.hideColumn("rowId",{},!0,!0),n.refreshColumns()):n.config.header||t||(n.config.header=!0,n.isColumnVisible("rowId")||n.showColumn("rowId",{},!0),n.refreshColumns())}function o(e,t){t.table.headers=e.$$("cells").config.header?1:0}function i(e,t){var o=!1;t.table&&!webix.isUndefined(t.table.headers)&&(o=!t.table.headers),n(e,o)}t.__esModule=!0,t.hideHeaders=n,t.serialize=o,t.load=i},function(e,t,n){"use strict";function o(e){e.attachEvent("onCommand",function(t){"create-filter"===t.id&&s(e)}),e.attachEvent("onUndo",function(t,n,o,i){"filter"===t?i?s(e,i):e.removeFilter():"dropdown"==t&&e.setCellEditor(n,o,i)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&l(t.name,t.inc,t.data,t.start)})}function i(e){var t=e._ssFilters,n=[];for(var o in t)for(var i in t[o])n.push(t[o][i]);return n}function r(e,t){for(var n=i(e._table),o=e._table._ssEditors,r=t.filters=[],a=0;a<n.length;a++){var s=n[a],l=s[0],u=s[1],c=o[l][u].options;c&&r.push([l,u,c])}}function a(e,t){var n,o=t.filters;if(o)for(n=0;n<o.length;n++)e.setCellFilter.apply(e,o[n])}function s(e,t){if(t=t||e._table.getSelectArea(),e.removeFilter(),t){u.group.start();for(var n=t.start.column;n<=t.end.column;n++){var o=t.start.row,i=(0,c.toRange)(o+1,n,t.end.row,n);e.setCellFilter(o,n,i),e.callEvent("onAction",["filter",{row:o,column:n,value:null,newValue:t}])}u.group.end()}}function l(e,t,n,o){var i=void 0,r=n.filters;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1],u=a[2];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l,r[i][2]=(0,c.changeRange)(u,e,t,o))}}t.__esModule=!0,t.init=o,t.getFilters=i,t.serialize=r,t.load=a;var u=n(39),c=n(41)},function(e,t){"use strict";function n(e){var t;window.XMLHttpRequest&&(new XMLHttpRequest).upload&&(t=webix.ui({view:"uploader",apiOnly:!0}),t.attachEvent("onBeforeFileAdd",webix.bind(function(t){return e.reset(),e.parse(t.file,"excel"),!1},this))),e.attachEvent("onCommand",function(n){"excel-import"===n.id&&o(e,t)})}function o(e,t){t?webix.delay(function(){return t.fileDialog()}):webix.alert(webix.i18n.spreadsheet.labels["import-not-support"])}t.__esModule=!0,t.init=n},function(e,t){"use strict";function n(e,t){var n=e._activeSheet,o=r(e,t,n);webix.html.insertBefore(o,t.docFooter,document.body),window.print(),i(e,o),e.showSheet(n)}function o(e){e.$customPrint=function(t){n(e,t)}}function i(e,t){webix.html.remove(t),e._sheets.forEach(function(t,n){webix.html.removeStyle(".wss_"+e.$index+"_"+n)})}function r(e,t,n){var o=webix.html.create("div",{"class":"webix_ssheet_print"});t.xCorrection=1,t.header=t.header||!1,t.trim=!!webix.isUndefined(t.trim)||t.trim,t.sheetnames=!!webix.isUndefined(t.sheetnames)||t.sheetnames;var i=e.$index;return e._sheets.forEach(function(r,a){if(e.$index=i+"_"+a,"all"===t.data||"all"!==t.data&&r.name===n){e.showSheet(r.name);var s="wss_"+e.$index;if(t.sheetnames){var l=webix.html.create("div",{"class":"webix_view webix_ssheet_sheetname"},r.name+":");o.appendChild(l)}var u=e._table.$customPrint(t,!0);if(u.firstChild&&(u.firstChild.className+=" "+s),o.appendChild(u),"all"==t.data&&a+1<e._sheets.length){var c=webix.html.create("DIV",{"class":"webix_print_pagebreak"});o.appendChild(c)}}}),e.$index=i,o}t.__esModule=!0,t.print=n,t.init=o},function(e,t,n){"use strict";function o(e){e.$exportView=function(t){return webix.extend(t,{header:!1,rawValues:!0,spans:!0,styles:!0,math:!0,xCorrection:1,ignore:{rowId:!0}}),"excel"==t.export_mode?i(e,t):e._table}}function i(e,t){t.sheets===!0?t.sheets=e._sheets.map(function(e){return e.name}):t.sheets&&t.sheets.length?"string"==typeof t.sheets&&(t.sheets=[t.sheets]):t.sheets=[e._activeSheet],t.dataOnly=!0;for(var n=[],o=e._activeSheet,i=0;i<t.sheets.length;i++){e.showSheet(t.sheets[i]),n=n.concat(webix.toExcel(e._table,t)),n[i].ranges=[];for(var r=e.ranges.getRanges(),a=0;a<r.length;a++)n[i].ranges.push({Sheet:i,Name:r[a].name,Ref:t.sheets[i]+"!"+r[a].range.replace(/(\w)/gi,function(e){return"$"+e})});t.styles&&(n[i].styles=s(e,t))}return e.showSheet(o),delete t.dataOnly,n}function r(e){return e=e.substring(1),3===e.length&&(e+=e),e}function a(){var e=f.defaultStyles;return{font:{sz:.75*e["font-size"].replace("px",""),name:e["font-family"].replace(/,.*$/,"")},alignment:{horizontal:e["text-align"],vertical:"middle"==e["vertical-align"]?"center":e["vertical-align"],wrapText:"nowrap"!=e["white-space"]}}}function s(e,t){e.compactStyles();var n=e.serialize(),o=n.styles,i=n.data,r=[],s=0,c=a();if(t.docHeader&&(r=r.concat([{0:u(t.docHeader.css,c)},{}])),t.header&&r.push({}),s=r.length,o.length){for(var f=0;f<o.length;f++)o[o[f][0]]=l(o[f][1]);for(var d=0;d<i.length;d++){var h=i[d][0]-1+s,p=i[d][1]-1;r[h]=r[h]||{},i[d][3]&&o[i[d][3]]?r[h][p]=o[i[d][3]]:r[h][p]=c}}return t.docFooter&&(r=r.concat([{},{0:u(t.docFooter.css,c)}])),r}function l(e){for(var t=e.split(";"),n={font:{},alignment:{},border:{}},o=0;o<t.length;o++)if(t[o])switch(c.style_names[o]){case"color":n.font.color={rgb:r(t[o])};break;case"background":var i=r(t[o]);i&&"ffffff"!==i.toLowerCase()&&(n.fill={fgColor:{rgb:i}});break;case"text-align":n.alignment.horizontal=t[o];break;case"font-family":n.font.name=t[o].replace(/,.*$/,"");break;case"font-size":n.font.sz=.75*t[o].replace("px","");break;case"font-style":n.font.italic=!0;break;case"text-decoration":n.font.underline=!0;break;case"font-weight":n.font.bold=!0;break;case"vertical-align":n.alignment.vertical="middle"==t[o]?"center":t[o];break;case"wrap":n.alignment.wrapText="wrap"==t[o];break;case"borders":break;case"format":break;case"border-right":n.border.right={color:{rgb:r(t[o])},style:"thin"};break;case"border-bottom":n.border.bottom={color:{rgb:r(t[o])},style:"thin"};break;case"border-left":n.border.left={color:{rgb:r(t[o])},style:"thin"};break;case"border-top":n.border.top={color:{rgb:r(t[o])},style:"thin"}}return n}function u(e){if(!e)return{};for(var t=[],n=0;n<c.style_names.length;n++)t.push(e[c.style_names[n]]||"");return l(t.join(";"))}t.__esModule=!0,t.init=o;var c=n(38),f=n(32)},function(e,t,n){"use strict";function o(e){e._parseExcel=function(t,n){var o=t.options||{};o.math=e.config.math;for(var r={sheets:[]},a=0;a<t.names.length;a++)o.name=t.names[a],r.sheets.push({name:o.name,content:i(n.getSheet(t,o),t.ranges,a)});return r},e._parseCsv=function(e,t){e=t.getRecords(e);for(var n=webix.copy(e),o=[],i=0;i<n.length;i++)for(var r=n[i].split(t.cell),a=0;a<r.length;a++){var s=i+1,l=a+1;o.push([s,l,r[a]])}return{data:o}}}function i(e,t,n){for(var o=webix.copy(e.data),i=[],r=0;r<o.length;r++)for(var a=0;a<o[0].length;a++){var l=r+1,u=a+1;i.push([l,u,o[r][a]])}if(e.data=i,e.spans)for(var c=0;c<e.spans.length;c++)e.spans[c][0]++,e.spans[c][1]++;if(t)for(var f=0;f<t.length;f++)t[f].Sheet===n&&(e.ranges=e.ranges||[],e.ranges.push([t[f].Name.toUpperCase(),t[f].Ref.substring(t[f].Ref.indexOf("!")+1).replace(/\$/g,"")]));if(e.styles&&(e=s(e)),e.sizes)for(var d=0;d<e.sizes.length;d++)"column"==e.sizes[d][0]?e.sizes[d]=[0,e.sizes[d][1]+1,e.sizes[d][2]]:e.sizes[d]=[e.sizes[d][1]+1,0,e.sizes[d][2]];return e}function r(e){return e=e||"000000",8===e.length&&(e=e.substring(2)),"#"+e}function a(e){for(var t="'PT Sans', Tahoma",n=0;n<u.fontFamily.length;n++)if(u.fontFamily[n].value==e){t=u.fontFamily[n].id;break}return t}function s(e){for(var t={},n=[],o=1,i=0;i<e.styles.length;i++){for(var s=[],u=e.styles[i][2],f=void 0,d=0;d<l.style_names.length;d++)switch(l.style_names[d]){case"color":s[d]=u.font&&u.font.color?r(u.font.color.rgb)||"":"";break;case"background":s[d]=u.fill&&u.fill.fgColor?r(u.fill.fgColor.rgb)||"":"";break;case"text-align":s[d]=(u.alignment?u.alignment.horizontal:"")||c.defaultStyles["text-align"];break;case"font-family":s[d]=u.font&&u.font.name?a(u.font.name):"";break;case"font-size":s[d]=u.font&&u.font.sz?u.font.sz/.75+"px"||"":"";break;case"font-style":s[d]=u.font&&u.font.italic?"italic":"";break;case"text-decoration":s[d]=u.font&&u.font.underline?"underline":"";break;case"font-weight":s[d]=u.font&&u.font.bold?"bold":"";break;case"vertical-align":var h=u.alignment?u.alignment.vertical||"":"";s[d]=("center"==h?"middle":h)||c.defaultStyles["vertical-align"];break;case"wrap":s[d]=u.alignment&&u.alignment.wrapText?"wrap":"nowrap";break;case"borders":s[d]="";break;case"format":s[d]="";break;case"border-right":s[d]=u.border&&u.border.right?r(u.border.right.color.rgb)||"":"";break;case"border-bottom":s[d]=u.border&&u.border.bottom?r(u.border.bottom.color.rgb)||"":"";break;case"border-left":s[d]=u.border&&u.border.left?r(u.border.left.color.rgb)||"":"";break;case"border-top":s[d]=u.border&&u.border.top?r(u.border.top.color.rgb)||"":""}s=s.join(";"),f=t[s]||"wss"+o;for(var p=0;p<e.data.length;p++)if(e.data[p][0]===e.styles[i][0]+1&&e.data[p][1]===e.styles[i][1]+1){e.data[p][3]=f;break}t[s]||(n.push([f,s]),t[s]=f,o++)}return e.styles=n,e}t.__esModule=!0,t.init=o;var l=n(38),u=n(33),c=n(32)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=[a,l,c,d,p,g,m,_,x,$,E,k,M],n=0;n<t.length;n++)webix.extend(e,t[n])}t.__esModule=!0,t.api=i;var r=n(91),a=o(r),s=n(92),l=o(s),u=n(93),c=o(u),f=n(94),d=o(f),h=n(95),p=o(h),v=n(96),g=o(v),w=n(97),m=o(w),b=n(98),_=o(b),y=n(99),x=o(y),C=n(100),$=o(C),S=n(101),E=o(S),V=n(102),k=o(V),R=n(103),M=o(R)},function(e,t){"use strict";function n(e){s(this,"add","row",e)}function o(e){s(this,"del","row",e)}function i(e){s(this,"add","column",e)}function r(e){s(this,"del","column",e)}function a(e,t,n){if(t)webix.isArray(t)||(t=[t,t]);else{var o=e.$$("cells").getSelectArea();o&&(t=[o.start[n],o.end[n]])}return t}function s(e,t,n,o){var i={},r={};o=a(e,o,n),i[n]=o[0],r[n]=o[1],e.callEvent("onCommand",[{id:t,group:n},i,r])}t.__esModule=!0,t.insertRow=n,t.deleteRow=o,t.insertColumn=i,t.deleteColumn=r},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t,n){s.lockCell(this,e,t,n)}function r(e,t){return s.isCellLocked(this,e,t)}t.__esModule=!0,t.lockCell=i,t.isCellLocked=r;var a=n(40),s=o(a)},function(e,t){"use strict";function n(e){var t=this.$$("cells"),n=t.config.leftSplit-1;if(e===!1&&(e=0),webix.isUndefined(e)){var o=this.getSelectedId(!0);e=o.length?o[0].column:0}if(t.config.leftSplit>1){var i=e-n;i||(e=0)}t.unselect(),t.define("leftSplit",e?e+1:1),t.refreshColumns(),this.callEvent("onAction",["freeze-column",{value:n,newValue:e}])}function o(e){var t=this.$$("cells"),n=t.config.topSplit;n==e&&(e=0),t.unselect(),t.define("topSplit",e||0),t.refreshColumns(),this.callEvent("onAction",["freeze-row",{value:n,newValue:e}])}t.__esModule=!0,t.freezeColumns=n,t.freezeRows=o},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){a.hideGridlines(this,e)}t.__esModule=!0,t.hideGridlines=i;var r=n(83),a=o(r)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){a.hideHeaders(this,e)}t.__esModule=!0,t.hideHeaders=i;var r=n(84),a=o(r)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){u.setColumnState(this,e,t)}function r(e){return u.isColumnVisible(this,e)}function a(e,t){u.setRowState(this,e,t)}function s(e){return u.isRowVisible(this,e)}t.__esModule=!0,t.hideColumn=i,t.isColumnVisible=r,t.hideRow=a,t.isRowVisible=s;var l=n(76),u=o(l)},function(e,t,n){"use strict";function o(e,t,n){this.setCellValue(e,t,(0,l.image)(n)),this.callEvent("onStyleSet",["format","image"])}function i(e,t,n){var o=(0,l.chart)(n);this.setCellValue(e,t,o),this.refresh()}function r(e){return(0,u.getAccessor)(this,e)}function a(){this.callEvent("onMathRefresh",[])}t.__esModule=!0,t.registerMathMethod=void 0,t.addImage=o,t.addSparkline=i,t.getSheetData=r,t.recalculate=a;var s=n(44),l=n(53),u=n(56);t.registerMathMethod=s.addMethod},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){var t=this;if(!e){var n=this.getSelectedId(!0);n.length>1&&(e=V.getRange(n))}R.group.set(function(){e&&t.callEvent("onBeforeSpan",[e.cell.row,e.cell.column,[e.x,e.y]])&&V.addSpan(t,e.cell,e.x,e.y)}),this.refresh()}function r(e,t){e&&t?V.removeSpan(this,{row:e,column:t}):R.group.set(function(){this.eachSelectedCell(function(e){var t=this._table.getSpan(e.row,e.column);t&&this.callEvent("onBeforeSplit",[e.row,e.column,[t[2],t[3]],R.group.value])&&V.removeSpan(this,e)})},this),this.refresh()}function a(e,t){return I.addStyle(this,e,t)}function s(e,t){return I.getStyle(this,{row:e,column:t})}function l(e,t,n){return I.setStyle(this,{row:e,column:t},n)}function u(e,t){R.group.set(function(){I.setRangeStyle(this,e,t)},this)}function c(e,t){(e||(e=this._table.getSelectArea()))&&(t||(t={styles:!0,values:!0,editors:!0}),t.styles&&I.clearRangeStyle(this,e),t.values&&this.setRangeValue(e,null),t.editors&&(0,T.clearEditors)(this,e),this.refresh())}function f(e,t,n){var o=this.getStyle(e,t),i=O.addFormat(n),r=I.addStyle(this,{format:i},o);this.setStyle(e,t,r)}function d(){return I.compactStyles(this)}function h(e){var t={};return this.callEvent("onDataSerialize",[t,e]),e&&e.sheets?S.serialize(this,t):t}function p(e){S.show(this,e)}function v(){return this._activeSheet}function g(e){S.add(this,e)}function w(){this.reset()}function m(e,t){S.rename(this,e,t)}function b(e){S.edit(this,e)}function _(e){S.remove(this,e)}function y(){R.undo(this)}function x(){R.redo(this)}function C(e,t){U.sortRange(this,e,t)}t.__esModule=!0,t.combineCells=i,t.splitCell=r,t.addStyle=a,t.getStyle=s,t.setStyle=l,t.setRangeStyle=u,t.clearRange=c,t.setFormat=f,t.compactStyles=d,t.serialize=h,t.showSheet=p,t.getActiveSheet=v,t.addSheet=g,t.clearSheet=w,t.renameSheet=m,t.editSheet=b,t.removeSheet=_,t.undo=y,t.redo=x,t.sortRange=C;var $=n(48),S=o($),E=n(81),V=o(E),k=n(39),R=o(k),M=n(38),I=o(M),A=n(34),O=o(A),z=n(79),U=o(z),T=n(75)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e?this._table.refreshColumns():this._table.refresh()}function r(e){for(var t=this.getSelectedId(!0),n=0;n<t.length;n++)e.call(this,t[n])}function a(e){var t=this._table.getSelectArea();return t?(e&&(e=this.getActiveSheet()),(0,v.toRange)(t.start.row,t.start.column,t.end.row,t.end.column,e)):""}function s(e){var t=this._table.getSelectArea();if(!e)return t&&t.start.row?t.start:null;var n=[];if(t)for(var o=t.start,i=t.end,r=o.row;r<=i.row;r++)for(var a=o.column;a<=i.column;a++)n.push({row:r,column:a});return n}function l(e,t){var n=this.getRow(e),o=n["$"+t]||n[t];return"undefined"==typeof o?"":o}function u(e,t,n){var o=this.getRow(e),i=o["$"+t]||o[t];this.callEvent("onBeforeValueChange",[e,t,n,i])&&(o[t]=n,delete o["$"+t],this.callEvent("onCellChange",[e,t,n,!0]),this.saveCell(e,t))}function c(e,t){m.group.set(function(){for(var n=(0,v.rangeObj)(e,this),o=n.start.row;o<=n.end.row;o++)for(var i=n.start.column;i<=n.end.column;i++)this.setCellValue(o,i,t)},this)}function f(e){return this._table.getItem(e)}function d(e){return this._table.getColumnConfig(e)}function h(e){var t={data:[]};e&&e.sheets&&(t=(0,b.newSheet)(t)),this.parse(t)}function p(){w.reset(this)}t.__esModule=!0,t.refresh=i,t.eachSelectedCell=r,t.getSelectedRange=a,t.getSelectedId=s,t.getCellValue=l,t.setCellValue=u,t.setRangeValue=c,t.getRow=f,t.getColumn=d,t.reset=h,t._resetTable=p;var v=n(41),g=n(36),w=o(g),m=n(39),b=n(48)},function(e,t){"use strict";function n(e,t){var n=this.config.save,o="";"string"==typeof n?o=n+"/"+e:n&&n[e]&&(o=n[e]),o&&(o.$proxy&&o.save?o.save(this,t,null,null):webix.ajax().post(o,t))}function o(e,t){var n=this.getStyle(e,t);this._save("data",{row:e,column:t,value:this.getCellValue(e,t),style:n?n.id:""})}t.__esModule=!0,t._save=n,t.saveCell=o},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return this._table.getItem(e)}function r(e,t,n){this.setCellEditor(e,t,{editor:"richselect",options:n}),this.addFilter(e,t)}function a(e,t,n){var o=this._table._ssEditors[e]=this._table._ssEditors[e]||{},i=o[t]||this._table.getItem(e)[t];o[t]=n,n&&n.editor?this._table.addCellCss(e,t,"ss_filter"):(delete this._table._ssEditors[e][t],this._table.removeCellCss(e,t,"ss_filter")),this.callEvent("onAction",["dropdown",{row:e,column:t,value:i,newValue:n}])}function s(e,t){var n=this._table._ssEditors[e]||{};return n[t]||null}function l(e,t){return d.addCellFilter(this,e,t)}function u(){for(var e=(0,h.getFilters)(this._table),t=0;t<e.length;t++){var n=e[t],o=n[0],i=n[1],r=this.getCellEditor(o,i);this.setCellEditor(o,i,null),this._table.removeCellCss(o,i,"ss_filter"),this.callEvent("onAction",["filter",{row:o,column:i,value:r,newValue:null}])}this._table._ssFilters=[],this._table.data.filter(function(){return!0})}function c(){this._table.data.silent(function(){for(var e=this,t=(0,h.getFilters)(this._table),n=function(){var n=t[o],a=n[0],s=n[1];i=e._table.getItem(a)[s],r=!1,e._table.data.filter(function(e){return!i||(1*e.id<=1*a||(e[s]||"0"===e[s]||(r=!0),r||e[s]==i))},1,o)},o=0;o<t.length;o++){var i,r;n()}},this),this._table.refresh()}t.__esModule=!0,t.getRow=i,t.setCellFilter=r,t.setCellEditor=a,t.getCellEditor=s,t.addFilter=l,t.removeFilter=u,t.filterSpreadSheet=c;var f=n(75),d=o(f),h=n(85)},function(e,t){"use strict";function n(e){var t=this;webix.modalbox({type:"alert webix_ssheet_confirm",text:e.text,buttons:[webix.i18n.spreadsheet.labels.cancel,webix.i18n.spreadsheet.labels.ok],callback:function(n){e.callback.call(t,"0"!=n)}})}function o(e){webix.modalbox({type:"alert webix_ssheet_alert",text:e.text,buttons:[webix.i18n.spreadsheet.labels.ok]})}t.__esModule=!0,t.confirm=n,t.alert=o},function(e,t,n){"use strict";function o(){(0,i.reset)(this)}t.__esModule=!0,t.resetUndo=o;var i=n(39)},function(e,t){"use strict";function n(e){e.attachEvent("onComponentInit",function(){return o(e)});var t=e.config,n={view:"menu",borderless:!1,css:"webix_ssheet_menu",id:"menu",autowidth:!0,type:{height:40},data:a.getMenuData(webix.isArray(t.menu)?t.menu:r)};return e.callEvent("onViewInit",["menu",n]),n}function o(e){e.$$("menu")&&e.$$("menu").attachEvent("onMenuItemClick",function(t){return i(e,t)})}function i(e,t){e.callEvent("onMenuItemClick",[t])&&(s[t]?s[t](e):e.callEvent("onCommand",[{id:t}]))}t.__esModule=!0,t.init=n;var r=[{id:"file",submenu:[{id:"sheet",submenu:[{id:"new-sheet"},{id:"copy-sheet"},{id:"remove-sheet"}]},{id:"excel-import"},{id:"excel-export"}]},{id:"edit",submenu:[{id:"add-range"},{id:"add-dropdown"},{id:"add-link"},{id:"lock-cell"},{id:"conditional-format"},{id:"clear-styles"}]},{id:"insert",submenu:[{id:"add-image"},{id:"add-sparkline"}]},{id:"data",submenu:[{id:"sort",submenu:[{id:"sort-asc"},{id:"sort-desc"}]},{id:"create-filter"}]},{id:"view",submenu:[{id:"columns",submenu:[{id:"insert-column"},{id:"delete-column"},{id:"show-column"},{id:"hide-column"}]},{id:"rows",submenu:[{id:"insert-row"},{id:"delete-row"},{id:"show-row"},{id:"hide-row"}]},{$template:"Separator"},{id:"freeze-columns"},{id:"freeze-rows"},{id:"hide-gridlines"},{id:"hide-headers"}]}],a={getMenuData:function(e){var t;for(t=0;t<e.length;t++)"string"==typeof e[t]&&(e[t]={id:e[t]}),e[t].value||(e[t].value=webix.i18n.spreadsheet.menus[e[t].id]),e[t].submenu&&(e[t].submenu=this.getMenuData(e[t].submenu));return e}},s={undo:function(e){e.undo()},redo:function(e){e.redo()},"insert-column":function(e){e.insertColumn()},"delete-column":function(e){e.deleteColumn()},"show-column":function(e){e.hideColumn(null,!1)},"hide-column":function(e){e.hideColumn(null,!0)},"insert-row":function(e){e.insertRow()},"delete-row":function(e){e.deleteRow()},"show-row":function(e){e.hideRow(null,!1)},"hide-row":function(e){e.hideRow(null,!0)},"freeze-columns":function(e){e.freezeColumns()},"hide-gridlines":function(e){e.hideGridlines("toggle")},"hide-headers":function(e){e.hideHeaders("toggle")}}},function(e,t){"use strict";function n(e){var t=webix.i18n.spreadsheet.labels;return t[e]||e}function o(){return[{name:n("normal"),css:"webix_ssheet_condition_regular"},{name:n("neutral"),css:"webix_ssheet_condition_neutral"},{name:n("bad"),css:"webix_ssheet_condition_bad"},{name:n("good"),css:"webix_ssheet_condition_good"}]}t.__esModule=!0,t.getDefaultStyles=o},function(e,t){"use strict"}]);